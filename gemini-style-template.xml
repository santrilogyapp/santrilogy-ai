<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>
<html b:css='false' b:defaultwidgetversion='2' b:layoutsVersion='3' b:responsive='true' b:templateUrl='indie.xml' b:templateVersion='1.0.0' expr:dir='data:blog.languageDirection' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
  <head>
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover' name='viewport'/>
    <!-- Legacy Apple meta tag (deprecated) -->
    <meta content='yes' name='apple-mobile-web-app-capable'/>
    <!-- Modern web app capable tag -->
    <meta content='yes' name='mobile-web-app-capable'/>
    <meta content='black-translucent' name='apple-mobile-web-app-status-bar-style'/>
    <title><data:blog.pageTitle/></title>
    
    <link href='https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&amp;display=swap' rel='stylesheet'/>
    <link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css' rel='stylesheet'/>

    <b:skin><![CDATA[
      /* ============================================
         SANTRILOGY AI - ULTRA RESPONSIVE
         ============================================ */
      
      :root {
        --bg-primary: #ffffff;
        --bg-secondary: #f8f9fb;
        --bg-tertiary: #f0f1f5;
        --bg-glass: rgba(255,255,255,0.85);
        --bg-modal: rgba(255,255,255,0.98);
        --text-primary: #111827;
        --text-secondary: #4b5563;
        --text-muted: #9ca3af;
        --accent: #6366f1;
        --accent-2: #8b5cf6;
        --accent-3: #06b6d4;
        --accent-soft: rgba(99,102,241,0.1);
        --gradient-1: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #06b6d4 100%);
        --gradient-2: linear-gradient(180deg, transparent 0%, var(--bg-primary) 100%);
        --border: rgba(0,0,0,0.08);
        --border-light: rgba(0,0,0,0.04);
        --shadow-xs: 0 1px 2px rgba(0,0,0,0.04);
        --shadow-sm: 0 2px 8px rgba(0,0,0,0.06);
        --shadow-md: 0 4px 20px rgba(0,0,0,0.08);
        --shadow-lg: 0 12px 40px rgba(0,0,0,0.12);
        --shadow-xl: 0 20px 50px rgba(0,0,0,0.15);
        --radius-xs: 8px;
        --radius-sm: 12px;
        --radius-md: 16px;
        --radius-lg: 24px;
        --radius-xl: 32px;
        --radius-full: 9999px;
        --safe-bottom: env(safe-area-inset-bottom, 0px);
        --safe-top: env(safe-area-inset-top, 0px);
        --header-h: 60px;
        --input-h: 130px;
        --sidebar-w: 280px;
        --font-xs: 11px;
        --font-sm: 13px;
        --font-base: 15px;
        --font-md: 16px;
        --font-lg: 18px;
        --font-xl: 24px;
        --font-2xl: 32px;
      }

      [data-theme="dark"] {
        --bg-primary: #09090b;
        --bg-secondary: #111113;
        --bg-tertiary: #18181b;
        --bg-glass: rgba(17,17,19,0.9);
        --bg-modal: rgba(17,17,19,0.98);
        --text-primary: #fafafa;
        --text-secondary: #a1a1aa;
        --text-muted: #52525b;
        --border: rgba(255,255,255,0.08);
        --border-light: rgba(255,255,255,0.04);
      }

      [data-accent="blue"] { --accent: #3b82f6; --accent-2: #2563eb; --accent-soft: rgba(59,130,246,0.1); }
      [data-accent="green"] { --accent: #10b981; --accent-2: #059669; --accent-soft: rgba(16,185,129,0.1); }
      [data-accent="purple"] { --accent: #8b5cf6; --accent-2: #7c3aed; --accent-soft: rgba(139,92,246,0.1); }
      [data-accent="pink"] { --accent: #ec4899; --accent-2: #db2777; --accent-soft: rgba(236,72,153,0.1); }
      [data-accent="orange"] { --accent: #f97316; --accent-2: #ea580c; --accent-soft: rgba(249,115,22,0.1); }

      [data-fontsize="small"] { --font-base: 13px; --font-md: 14px; }
      [data-fontsize="large"] { --font-base: 17px; --font-md: 18px; }

      *, *::before, *::after {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
      }

      html { height: 100%; height: -webkit-fill-available; }

      body {
        font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
        background: var(--bg-primary);
        color: var(--text-primary);
        font-size: var(--font-base);
        line-height: 1.6;
        min-height: 100vh;
        min-height: -webkit-fill-available;
        overflow-x: hidden;
        -webkit-font-smoothing: antialiased;
        transition: background 0.3s, color 0.3s;
      }

      body::before {
        content: '';
        position: fixed;
        inset: 0;
        background: 
          radial-gradient(ellipse at 20% 0%, rgba(99,102,241,0.05) 0%, transparent 50%),
          radial-gradient(ellipse at 80% 100%, rgba(139,92,246,0.05) 0%, transparent 50%);
        pointer-events: none;
        z-index: -1;
      }

      a { text-decoration: none; color: inherit; }
      button { font-family: inherit; cursor: pointer; border: none; background: none; }
      .navbar, .attribution, #blog-pager, .post-footer, .post-header { display: none !important; }

      /* ============================================
         ANIMATED ATOM LOGO
         ============================================ */
      
      .atom-logo {
        width: 40px;
        height: 40px;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
      }

      .atom-nucleus {
        width: 8px;
        height: 8px;
        background: var(--gradient-1);
        border-radius: 50%;
        position: absolute;
        box-shadow: 0 0 15px var(--accent);
        animation: pulse 2s ease-in-out infinite;
      }

      @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.15); }
      }

      .atom-orbit {
        position: absolute;
        border: 1.5px solid;
        border-radius: 50%;
        animation: spin 3s linear infinite;
      }

      .atom-orbit::after {
        content: '';
        position: absolute;
        width: 5px;
        height: 5px;
        background: currentColor;
        border-radius: 50%;
        top: -2.5px;
        left: 50%;
        transform: translateX(-50%);
        box-shadow: 0 0 6px currentColor;
      }

      .orbit-1 { width: 28px; height: 28px; border-color: rgba(99,102,241,0.4); color: #6366f1; animation-duration: 2s; }
      .orbit-2 { width: 32px; height: 18px; border-color: rgba(139,92,246,0.4); color: #8b5cf6; animation-duration: 2.5s; transform: rotate(60deg); animation-name: spin2; }
      .orbit-3 { width: 32px; height: 18px; border-color: rgba(6,182,212,0.4); color: #06b6d4; animation-duration: 3s; transform: rotate(-60deg); animation-name: spin3; }

      @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
      @keyframes spin2 { from { transform: rotate(60deg); } to { transform: rotate(420deg); } }
      @keyframes spin3 { from { transform: rotate(-60deg); } to { transform: rotate(300deg); } }

      .atom-lg { width: 100px; height: 100px; }
      .atom-lg .atom-nucleus { width: 18px; height: 18px; }
      .atom-lg .orbit-1 { width: 60px; height: 60px; }
      .atom-lg .orbit-2, .atom-lg .orbit-3 { width: 80px; height: 40px; }
      .atom-lg .atom-orbit::after { width: 10px; height: 10px; top: -5px; }

      .atom-mini { width: 100%; height: 100%; }
      .atom-mini .atom-nucleus { width: 5px; height: 5px; background: white; box-shadow: none; }
      .atom-mini .atom-orbit { border-width: 1px; }
      .atom-mini .orbit-1 { width: 20px; height: 20px; border-color: rgba(255,255,255,0.5); }
      .atom-mini .atom-orbit::after { width: 3px; height: 3px; top: -1.5px; background: white; box-shadow: none; }

      /* ============================================
         LAYOUT
         ============================================ */
      
      .app {
        display: flex;
        height: 100vh;
        height: 100dvh;
        position: relative;
        overflow: hidden;
      }

      /* ============================================
         SIDEBAR
         ============================================ */
      
      .sidebar {
        width: var(--sidebar-w);
        background: var(--bg-glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-right: 1px solid var(--border);
        display: flex;
        flex-direction: column;
        height: 100%;
        position: fixed;
        left: 0;
        top: 0;
        z-index: 200;
        transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .sidebar.collapsed { transform: translateX(-100%); }

      .sidebar-header {
        padding: 16px;
        border-bottom: 1px solid var(--border);
        display: flex;
        align-items: center;
        justify-content: space-between;
        min-height: var(--header-h);
      }

      .logo-wrap {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .logo-text {
        font-size: var(--font-lg);
        font-weight: 700;
        background: var(--gradient-1);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .sidebar-close {
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--bg-tertiary);
        border-radius: var(--radius-xs);
        color: var(--text-muted);
        transition: all 0.2s;
      }

      .sidebar-close:hover {
        background: var(--border);
        color: var(--text-primary);
      }

      .new-chat-btn {
        margin: 16px;
        padding: 14px;
        background: var(--gradient-1);
        border-radius: var(--radius-sm);
        color: white;
        font-size: var(--font-sm);
        font-weight: 600;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        transition: all 0.3s;
        box-shadow: 0 4px 15px rgba(99,102,241,0.25);
      }

      .new-chat-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(99,102,241,0.35);
      }

      .sidebar-nav {
        flex: 1;
        padding: 8px;
        overflow-y: auto;
        overscroll-behavior: contain;
      }

      .nav-group { margin-bottom: 16px; }

      .nav-label {
        font-size: var(--font-xs);
        font-weight: 600;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.8px;
        padding: 8px 12px;
      }

      .nav-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 11px 12px;
        border-radius: var(--radius-xs);
        color: var(--text-secondary);
        font-size: var(--font-sm);
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
        width: 100%;
        text-align: left;
      }

      .nav-item:hover {
        background: var(--bg-tertiary);
        color: var(--text-primary);
      }

      .nav-item.active {
        background: var(--accent-soft);
        color: var(--accent);
      }

      .nav-item i { width: 18px; text-align: center; }

      /* Sidebar Footer with Settings Dropdown */
      .sidebar-footer {
        padding: 12px;
        border-top: 1px solid var(--border);
        position: relative;
      }

      .profile-card {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 10px;
        border-radius: var(--radius-sm);
        cursor: pointer;
        transition: background 0.2s;
      }

      .profile-card:hover { background: var(--bg-tertiary); }

      .profile-avatar {
        width: 40px;
        height: 40px;
        background: var(--gradient-1);
        border-radius: var(--radius-xs);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: var(--font-sm);
      }

      .profile-info { flex: 1; min-width: 0; }

      .profile-name {
        font-size: var(--font-sm);
        font-weight: 600;
        color: var(--text-primary);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .profile-plan {
        font-size: var(--font-xs);
        color: var(--text-muted);
      }

      /* ============================================
         DESKTOP SETTINGS DROPDOWN
         ============================================ */
      
      .settings-dropdown {
        position: absolute;
        bottom: calc(100% + 8px);
        left: 12px;
        right: 12px;
        background: var(--bg-modal);
        border: 1px solid var(--border);
        border-radius: var(--radius-md);
        box-shadow: var(--shadow-xl);
        opacity: 0;
        visibility: hidden;
        transform: translateY(10px) scale(0.95);
        transform-origin: bottom center;
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 500;
        overflow: hidden;
      }

      .settings-dropdown.show {
        opacity: 1;
        visibility: visible;
        transform: translateY(0) scale(1);
      }

      .dropdown-header {
        padding: 14px 16px;
        border-bottom: 1px solid var(--border-light);
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .dropdown-title {
        font-size: var(--font-sm);
        font-weight: 600;
        color: var(--text-primary);
      }

      .dropdown-close {
        width: 28px;
        height: 28px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--bg-tertiary);
        border-radius: 6px;
        color: var(--text-muted);
        font-size: 12px;
        transition: all 0.2s;
      }

      .dropdown-close:hover {
        background: var(--border);
        color: var(--text-primary);
      }

      .dropdown-body {
        padding: 8px;
        max-height: 400px;
        overflow-y: auto;
      }

      .dropdown-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px;
        border-radius: var(--radius-xs);
        transition: background 0.2s;
      }

      .dropdown-item:hover {
        background: var(--bg-tertiary);
      }

      .dropdown-item-label {
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: var(--font-sm);
        font-weight: 500;
        color: var(--text-primary);
      }

      .dropdown-item-label i {
        width: 18px;
        color: var(--text-muted);
        font-size: 14px;
      }

      .dropdown-divider {
        height: 1px;
        background: var(--border-light);
        margin: 8px 0;
      }

      /* Toggle Mini */
      .toggle-mini {
        width: 40px;
        height: 22px;
        background: var(--bg-tertiary);
        border-radius: 11px;
        position: relative;
        cursor: pointer;
        transition: background 0.3s;
        border: 1px solid var(--border);
      }

      .toggle-mini::after {
        content: '';
        position: absolute;
        width: 16px;
        height: 16px;
        background: white;
        border-radius: 50%;
        top: 2px;
        left: 2px;
        transition: transform 0.3s;
        box-shadow: var(--shadow-xs);
      }

      .toggle-mini.on { background: var(--accent); border-color: var(--accent); }
      .toggle-mini.on::after { transform: translateX(18px); }

      /* Color Pills */
      .color-pills {
        display: flex;
        gap: 6px;
      }

      .color-pill {
        width: 22px;
        height: 22px;
        border-radius: 50%;
        border: 2px solid transparent;
        cursor: pointer;
        transition: all 0.2s;
      }

      .color-pill:hover { transform: scale(1.15); }
      .color-pill.active { border-color: var(--text-primary); }

      .color-pill.c-indigo { background: #6366f1; }
      .color-pill.c-blue { background: #3b82f6; }
      .color-pill.c-green { background: #10b981; }
      .color-pill.c-purple { background: #8b5cf6; }
      .color-pill.c-pink { background: #ec4899; }
      .color-pill.c-orange { background: #f97316; }
      .color-pill.c-custom { background: linear-gradient(45deg, #6366f1, #8b5cf6); }

      /* Size Buttons */
      .size-btns {
        display: flex;
        gap: 4px;
      }

      .size-btn {
        padding: 4px 10px;
        background: var(--bg-tertiary);
        border: 1px solid var(--border);
        border-radius: 6px;
        font-size: var(--font-xs);
        font-weight: 600;
        color: var(--text-muted);
        cursor: pointer;
        transition: all 0.2s;
      }

      .size-btn:hover { border-color: var(--accent); color: var(--accent); }
      .size-btn.active { background: var(--accent-soft); border-color: var(--accent); color: var(--accent); }

      /* ============================================
         MORE DROPDOWN
         ============================================ */

      .more-dropdown {
        position: absolute;
        top: var(--header-h);
        right: 16px;
        background: var(--bg-modal);
        border: 1px solid var(--border);
        border-radius: var(--radius-md);
        box-shadow: var(--shadow-xl);
        opacity: 0;
        visibility: hidden;
        transform: translateY(10px) scale(0.95);
        transform-origin: top right;
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 500;
        overflow: hidden;
        min-width: 220px;
      }

      .more-dropdown.show {
        opacity: 1;
        visibility: visible;
        transform: translateY(0) scale(1);
      }

      /* ============================================
         MAIN
         ============================================ */
      
      .main {
        flex: 1;
        display: flex;
        flex-direction: column;
        height: 100%;
        margin-left: var(--sidebar-w);
        transition: margin-left 0.35s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
      }

      .sidebar.collapsed ~ .main { margin-left: 0; }

      .header {
        height: var(--header-h);
        padding: 0 16px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: var(--bg-glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-bottom: 1px solid var(--border);
        position: sticky;
        top: 0;
        z-index: 100;
        padding-top: var(--safe-top);
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .menu-btn {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--bg-tertiary);
        border-radius: var(--radius-xs);
        color: var(--text-secondary);
        font-size: 18px;
        transition: all 0.2s;
      }

      .menu-btn:hover {
        background: var(--border);
        color: var(--text-primary);
      }

      .model-badge {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 12px;
        background: var(--bg-tertiary);
        border-radius: var(--radius-full);
        font-size: var(--font-xs);
        font-weight: 600;
        color: var(--text-secondary);
      }

      .model-dot {
        width: 6px;
        height: 6px;
        background: #22c55e;
        border-radius: 50%;
        animation: blink 2s infinite;
      }

      @keyframes blink {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.4; }
      }

      .header-right {
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .icon-btn {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: var(--radius-xs);
        color: var(--text-muted);
        font-size: 18px;
        transition: all 0.2s;
      }

      .icon-btn:hover {
        background: var(--bg-tertiary);
        color: var(--text-primary);
      }

      /* ============================================
         CHAT AREA
         ============================================ */
      
      .chat-area {
        flex: 1;
        overflow-y: auto;
        overscroll-behavior: contain;
        -webkit-overflow-scrolling: touch;
        padding: 24px 16px;
        padding-bottom: calc(var(--input-h) + 20px);
      }

      .chat-container {
        max-width: 720px;
        margin: 0 auto;
        width: 100%;
      }

      .post-outer {
        margin-bottom: 28px;
        animation: msgIn 0.4s ease-out;
      }

      @keyframes msgIn {
        from { opacity: 0; transform: translateY(16px); }
        to { opacity: 1; transform: translateY(0); }
      }

      .msg {
        display: flex;
        gap: 14px;
        align-items: flex-start;
      }

      .msg-avatar {
        width: 36px;
        height: 36px;
        border-radius: var(--radius-xs);
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
      }

      .msg-avatar.ai {
        background: var(--gradient-1);
        box-shadow: 0 4px 12px rgba(99,102,241,0.25);
      }

      .msg-avatar.user {
        background: var(--bg-tertiary);
        color: var(--text-secondary);
        font-weight: 600;
        font-size: var(--font-sm);
      }

      .msg-body { flex: 1; min-width: 0; }

      .msg-header {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 8px;
      }

      .msg-name {
        font-size: var(--font-sm);
        font-weight: 600;
        color: var(--text-primary);
      }

      .msg-time {
        font-size: var(--font-xs);
        color: var(--text-muted);
      }

      .post-body {
        font-size: var(--font-base);
        line-height: 1.75;
        color: var(--text-primary);
      }

      .post-body p { margin-bottom: 14px; }
      .post-body p:last-child { margin-bottom: 0; }

      .post-body h2, .post-body h3 {
        font-size: var(--font-md);
        font-weight: 600;
        margin: 20px 0 10px;
      }

      .post-body blockquote {
        border-left: 3px solid var(--accent);
        background: var(--accent-soft);
        padding: 14px 16px;
        margin: 14px 0;
        border-radius: 0 var(--radius-xs) var(--radius-xs) 0;
        font-style: italic;
      }

      .post-body code {
        background: var(--bg-tertiary);
        padding: 2px 6px;
        border-radius: 4px;
        font-size: var(--font-sm);
        font-family: 'SF Mono', Consolas, monospace;
      }

      .msg-actions {
        display: flex;
        gap: 4px;
        margin-top: 12px;
        opacity: 0;
        transition: opacity 0.2s;
      }

      .post-outer:hover .msg-actions { opacity: 1; }

      .msg-action {
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 6px;
        color: var(--text-muted);
        cursor: pointer;
        transition: all 0.2s;
        font-size: 12px;
      }

      .msg-action:hover {
        background: var(--bg-tertiary);
        color: var(--accent);
      }

      /* ============================================
         WELCOME SCREEN
         ============================================ */
      
      .welcome {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 60vh;
        text-align: center;
        padding: 32px 20px;
      }

      .welcome-glow {
        position: absolute;
        width: 180px;
        height: 180px;
        background: var(--gradient-1);
        filter: blur(80px);
        opacity: 0.2;
        animation: glowMove 6s ease-in-out infinite;
      }

      @keyframes glowMove {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.2); }
      }

      .welcome-logo {
        position: relative;
        margin-bottom: 28px;
      }

      .welcome h1 {
        font-size: var(--font-2xl);
        font-weight: 700;
        background: var(--gradient-1);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 10px;
      }

      .welcome p {
        font-size: var(--font-md);
        color: var(--text-secondary);
        max-width: 380px;
        margin-bottom: 36px;
      }

      .suggestions {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        width: 100%;
        max-width: 500px;
      }

      .sug-card {
        padding: 16px;
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: var(--radius-sm);
        text-align: left;
        cursor: pointer;
        transition: all 0.25s;
      }

      .sug-card:hover {
        border-color: var(--accent);
        transform: translateY(-3px);
        box-shadow: var(--shadow-md);
      }

      .sug-icon {
        width: 32px;
        height: 32px;
        background: var(--accent-soft);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--accent);
        font-size: 14px;
        margin-bottom: 10px;
      }

      .sug-title {
        font-size: var(--font-sm);
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 4px;
      }

      .sug-desc {
        font-size: var(--font-xs);
        color: var(--text-muted);
        line-height: 1.4;
      }

      /* ============================================
         INPUT AREA
         ============================================ */
      
      .input-area {
        position: fixed;
        bottom: 0;
        left: var(--sidebar-w);
        right: 0;
        background: var(--gradient-2);
        padding: 16px;
        padding-bottom: calc(16px + var(--safe-bottom));
        z-index: 100;
        transition: left 0.35s cubic-bezier(0.4, 0, 0.2, 1);
      }

      [data-theme="dark"] .input-area {
        background: linear-gradient(180deg, transparent 0%, var(--bg-secondary) 100%);
      }

      .sidebar.collapsed ~ .main .input-area { left: 0; }

      .input-wrap {
        max-width: 720px;
        margin: 0 auto;
        position: relative;
      }

      .input-box {
        display: flex;
        align-items: flex-end;
        gap: 8px;
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: var(--radius-lg);
        padding: 10px 12px;
        transition: all 0.25s;
        box-shadow: var(--shadow-sm);
      }

      .input-box:focus-within {
        border-color: var(--accent);
        box-shadow: var(--shadow-md), 0 0 0 3px var(--accent-soft);
      }

      .input-left, .input-right {
        display: flex;
        align-items: center;
        flex-shrink: 0;
      }

      .input-btn {
        width: 42px;
        height: 42px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: var(--radius-xs);
        color: var(--text-muted);
        font-size: 20px;
        transition: all 0.2s;
        position: relative;
      }

      .input-btn:hover {
        background: var(--bg-tertiary);
        color: var(--text-secondary);
      }

      .input-btn.plus { color: var(--accent); }

      .input-field {
        flex: 1;
        border: none;
        background: transparent;
        font-family: inherit;
        font-size: var(--font-base);
        line-height: 1.5;
        color: var(--text-primary);
        resize: none;
        outline: none;
        min-height: 24px;
        max-height: 120px;
        padding: 9px 0;
      }

      .input-field::placeholder { color: var(--text-muted); }

      .send-mic-btn {
        width: 42px;
        height: 42px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: var(--radius-sm);
        font-size: 18px;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
      }

      .send-mic-btn.mic {
        background: var(--bg-tertiary);
        color: var(--text-secondary);
      }

      .send-mic-btn.send {
        background: var(--gradient-1);
        color: white;
        box-shadow: 0 4px 12px rgba(99,102,241,0.3);
        transform: scale(1.05);
      }

      .send-mic-btn.send:hover {
        transform: scale(1.1);
        box-shadow: 0 6px 20px rgba(99,102,241,0.4);
      }

      .input-footer {
        text-align: center;
        margin-top: 10px;
        font-size: var(--font-xs);
        color: var(--text-muted);
      }

      /* ============================================
         DESKTOP TOOLS DROPDOWN
         ============================================ */
      
      .tools-dropdown {
        position: absolute;
        bottom: calc(100% + 12px);
        left: 0;
        width: 320px;
        background: var(--bg-modal);
        border: 1px solid var(--border);
        border-radius: var(--radius-md);
        box-shadow: var(--shadow-xl);
        opacity: 0;
        visibility: hidden;
        transform: translateY(10px) scale(0.95);
        transform-origin: bottom left;
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 500;
        overflow: hidden;
      }

      .tools-dropdown.show {
        opacity: 1;
        visibility: visible;
        transform: translateY(0) scale(1);
      }

      .dropdown-section {
        padding: 12px;
        border-bottom: 1px solid var(--border-light);
      }

      .dropdown-section:last-child { border-bottom: none; }

      .dropdown-label {
        font-size: var(--font-xs);
        font-weight: 600;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 10px;
        padding: 0 4px;
      }

      .dropdown-upload {
        display: flex;
        gap: 8px;
      }

      .upload-item {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 6px;
        padding: 14px 10px;
        background: var(--bg-tertiary);
        border: 1px solid transparent;
        border-radius: var(--radius-sm);
        cursor: pointer;
        transition: all 0.2s;
      }

      .upload-item:hover {
        border-color: var(--accent);
        background: var(--accent-soft);
      }

      .upload-item i {
        font-size: 20px;
        color: var(--accent);
      }

      .upload-item span {
        font-size: var(--font-xs);
        font-weight: 500;
        color: var(--text-primary);
      }

      .dropdown-tools {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 6px;
      }

      .tool-item {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 12px;
        border-radius: var(--radius-xs);
        cursor: pointer;
        transition: all 0.2s;
      }

      .tool-item:hover {
        background: var(--bg-tertiary);
      }

      .tool-item i {
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--accent-soft);
        border-radius: var(--radius-xs);
        color: var(--accent);
        font-size: 14px;
        flex-shrink: 0;
      }

      .tool-item span {
        font-size: var(--font-sm);
        font-weight: 500;
        color: var(--text-primary);
      }

      /* ============================================
         MOBILE MODALS - Swipe Up Sheet
         ============================================ */
      
      .modal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.4);
        backdrop-filter: blur(4px);
        -webkit-backdrop-filter: blur(4px);
        z-index: 500;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s;
      }

      .modal-overlay.show {
        opacity: 1;
        visibility: visible;
      }

      .mobile-modal {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: var(--bg-modal);
        border-radius: var(--radius-xl) var(--radius-xl) 0 0;
        z-index: 501;
        transform: translateY(100%);
        transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        max-height: 85vh;
        overflow: hidden;
        display: none;
        flex-direction: column;
      }

      .mobile-modal.show { transform: translateY(0); }

      .modal-handle {
        width: 36px;
        height: 4px;
        background: var(--border);
        border-radius: 2px;
        margin: 12px auto;
        flex-shrink: 0;
      }

      .modal-header {
        padding: 8px 20px 16px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        border-bottom: 1px solid var(--border);
        flex-shrink: 0;
      }

      .modal-title {
        font-size: var(--font-md);
        font-weight: 600;
        color: var(--text-primary);
      }

      .modal-close {
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--bg-tertiary);
        border-radius: var(--radius-xs);
        color: var(--text-muted);
        font-size: 14px;
      }

      .modal-body {
        padding: 16px 20px;
        overflow-y: auto;
        flex: 1;
        padding-bottom: calc(20px + var(--safe-bottom));
      }

      .modal-section { margin-bottom: 24px; }
      .modal-section:last-child { margin-bottom: 0; }

      .modal-section-title {
        font-size: var(--font-xs);
        font-weight: 600;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 12px;
      }

      .modal-upload-grid {
        display: flex;
        gap: 12px;
      }

      .modal-upload-btn {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
        padding: 20px 16px;
        background: var(--bg-tertiary);
        border: 1px solid var(--border);
        border-radius: var(--radius-sm);
        cursor: pointer;
        transition: all 0.2s;
      }

      .modal-upload-btn:active {
        border-color: var(--accent);
        background: var(--accent-soft);
      }

      .modal-upload-btn i {
        font-size: 24px;
        color: var(--accent);
      }

      .modal-upload-btn span {
        font-size: var(--font-sm);
        font-weight: 500;
        color: var(--text-primary);
      }

      .modal-tools-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 10px;
      }

      .modal-tool-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 14px;
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: var(--radius-sm);
        cursor: pointer;
        transition: all 0.2s;
      }

      .modal-tool-item:active {
        border-color: var(--accent);
        transform: scale(0.98);
      }

      .modal-tool-icon {
        width: 40px;
        height: 40px;
        background: var(--accent-soft);
        border-radius: var(--radius-xs);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--accent);
        font-size: 16px;
        flex-shrink: 0;
      }

      .modal-tool-info { flex: 1; min-width: 0; }

      .modal-tool-name {
        font-size: var(--font-sm);
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 2px;
      }

      .modal-tool-desc {
        font-size: var(--font-xs);
        color: var(--text-muted);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      /* Mobile Settings Items */
      .mobile-setting-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 14px 0;
        border-bottom: 1px solid var(--border-light);
      }

      .mobile-setting-item:last-child { border-bottom: none; }

      .mobile-setting-label {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: var(--font-sm);
        font-weight: 500;
        color: var(--text-primary);
      }

      .mobile-setting-label i {
        width: 20px;
        color: var(--text-muted);
      }

      .toggle-switch {
        width: 48px;
        height: 28px;
        background: var(--bg-tertiary);
        border-radius: 14px;
        position: relative;
        cursor: pointer;
        transition: background 0.3s;
      }

      .toggle-switch::after {
        content: '';
        position: absolute;
        width: 22px;
        height: 22px;
        background: white;
        border-radius: 50%;
        top: 3px;
        left: 3px;
        transition: transform 0.3s;
        box-shadow: var(--shadow-xs);
      }

      .toggle-switch.on { background: var(--accent); }
      .toggle-switch.on::after { transform: translateX(20px); }

      .mobile-color-options {
        display: flex;
        gap: 8px;
      }

      .mobile-color-btn {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        border: 2px solid transparent;
        cursor: pointer;
        transition: all 0.2s;
      }

      .mobile-color-btn.active { border-color: var(--text-primary); }

      /* Mobile color picker improvements */
      #customColorPicker {
        width: 60px;
        height: 40px;
        border: none;
        outline: none;
        cursor: pointer;
        opacity: 0;
        position: absolute;
        top: 0;
        left: 0;
        z-index: -1;
      }

      @media (max-width: 768px) {
        #customColorPicker {
          width: 80px;
          height: 50px;
        }
      }

      .mobile-fontsize-btns {
        display: flex;
        gap: 6px;
      }

      .mobile-fontsize-btn {
        padding: 6px 12px;
        background: var(--bg-tertiary);
        border: 1px solid var(--border);
        border-radius: 6px;
        font-size: var(--font-xs);
        font-weight: 600;
        color: var(--text-muted);
        cursor: pointer;
        transition: all 0.2s;
      }

      .mobile-fontsize-btn.active {
        background: var(--accent-soft);
        border-color: var(--accent);
        color: var(--accent);
      }

      /* ============================================
         OVERLAY
         ============================================ */
      
      .overlay {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.5);
        backdrop-filter: blur(4px);
        -webkit-backdrop-filter: blur(4px);
        z-index: 199;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s;
      }

      .overlay.show {
        opacity: 1;
        visibility: visible;
      }

      /* ============================================
         RESPONSIVE - Desktop (dropdowns)
         ============================================ */
      
      @media (min-width: 769px) {
        .tools-dropdown,
        .settings-dropdown { display: block; }
        
        .mobile-modal { display: none !important; }
        .modal-overlay.mobile-overlay { display: none !important; }
      }

      /* ============================================
         RESPONSIVE - Mobile (modals)
         ============================================ */
      
      @media (max-width: 768px) {
        :root {
          --header-h: 56px;
          --input-h: 110px;
        }

        .tools-dropdown,
        .settings-dropdown { display: none !important; }
        
        .mobile-modal { display: flex; }

        .sidebar {
          position: fixed;
          width: 85%;
          max-width: 300px;
        }

        .main { margin-left: 0 !important; }
        .input-area { left: 0 !important; }
        .header { padding: 0 12px; }

        .model-badge span { display: none; }
        .model-badge { padding: 8px; min-width: 30px; justify-content: center; }

        .chat-area {
          padding: 16px 12px;
          padding-bottom: calc(var(--input-h) + 16px);
        }

        .suggestions { grid-template-columns: 1fr; }
        .welcome h1 { font-size: var(--font-xl); }
        .welcome p { font-size: var(--font-sm); }

        .msg { gap: 10px; }
        .msg-avatar { width: 32px; height: 32px; }

        .input-box { padding: 8px 10px; }
      }

      @media (max-width: 380px) {
        :root {
          --font-base: 14px;
          --font-md: 15px;
        }

        .input-btn { width: 38px; height: 38px; font-size: 18px; }
        .send-mic-btn { width: 38px; height: 38px; }

        .modal-upload-grid { flex-direction: column; }
        .modal-tools-grid { grid-template-columns: 1fr; }
      }

      @supports (padding: max(0px)) {
        .input-area { padding-bottom: max(16px, env(safe-area-inset-bottom)); }
        .header { padding-top: max(0px, env(safe-area-inset-top)); }
        .modal-body { padding-bottom: max(20px, env(safe-area-inset-bottom)); }
      }

      ::-webkit-scrollbar { width: 5px; height: 5px; }
      ::-webkit-scrollbar-track { background: transparent; }
      ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

      @media (max-width: 768px) {
        ::-webkit-scrollbar { display: none; }
        * { scrollbar-width: none; }
      }

    ]]></b:skin>
  </head>
  
 <body>
    <div class='app'>

      <div class='overlay' id='overlay' onclick='closeSidebar()'/>

      <aside class='sidebar' id='sidebar'>
        <div class='sidebar-header'>
          <div class='logo-wrap'>
            <div class='atom-logo'>
              <div class='atom-nucleus'/>
              <div class='atom-orbit orbit-1'/>
              <div class='atom-orbit orbit-2'/>
              <div class='atom-orbit orbit-3'/>
            </div>
            <span class='logo-text'>Santrilogy</span>
          </div>
          <button class='sidebar-close' onclick='closeSidebar()'>
            <i class='fas fa-times'/>
          </button>
        </div>

        <button class='new-chat-btn' onclick='startNewChat()'>
          <i class='fas fa-plus'/>
          New Chat
        </button>

        <nav class='sidebar-nav'>
          <div class='nav-group'>
            <div class='nav-label'>Menu</div>
            <button class='nav-item active'>
              <i class='fas fa-message'/>
              <span>Chat</span>
            </button>
            <button class='nav-item'>
              <i class='fas fa-compass'/>
              <span>Explore</span>
            </button>
            <button class='nav-item'>
              <i class='fas fa-book-open'/>
              <span>Kitab Library</span>
            </button>
          </div>

          <div class='nav-group'>
            <div class='nav-label'>Recent</div>
            <button class='nav-item'>
              <i class='fas fa-clock-rotate-left'/>
              <span>History</span>
            </button>
            <button class='nav-item'>
              <i class='fas fa-bookmark'/>
              <span>Saved</span>
            </button>
          </div>

          <div class='nav-group'>
            <div class='nav-label'>More</div>
            <button class='nav-item' onclick='toggleSettings()'>
              <i class='fas fa-gear'/>
              <span>Settings</span>
            </button>
            <button class='nav-item'>
              <i class='fas fa-gem'/>
              <span>Upgrade Pro</span>
            </button>
          </div>
        </nav>

        <div class='sidebar-footer'>
          <div class='settings-dropdown' id='settingsDropdown'>
            <div class='dropdown-header'>
              <span class='dropdown-title'>Settings</span>
              <button class='dropdown-close' onclick='closeSettingsDropdown()'>
                <i class='fas fa-times'/>
              </button>
            </div>
            <div class='dropdown-body'>
              <div class='dropdown-item'>
                <div class='dropdown-item-label'>
                  <i class='fas fa-moon'/>
                  <span>Dark Mode</span>
                </div>
                <button class='toggle-mini' id='darkToggleDesktop' onclick='toggleDarkMode()'/>
              </div>
              </div>
          </div>

          <div class='profile-card' onclick='toggleSettings()'>
            <div class='profile-avatar'>S</div>
            <div class='profile-info'>
              <div class='profile-name'>Santri User</div>
              <div class='profile-plan'>Free Plan</div>
            </div>
            <i class='fas fa-chevron-up' id='profileChevron' style='color: var(--text-muted); font-size: 12px; transition: transform 0.3s;'/>
          </div>
        </div>
      </aside>

      <div class='main'>
        <header class='header'>
          <div class='header-left'>
            <button class='menu-btn' onclick='toggleSidebar()'>
              <i class='fas fa-bars'/>
            </button>
            <div class='model-badge'>
              <div class='model-dot'/>
              <span>Santrilogy AI</span>
            </div>
          </div>
          <div class='header-right'>
            <button class='icon-btn' onclick='toggleMoreDropdown()' title='More'>
              <i class='fas fa-ellipsis-vertical'/>
            </button>
          </div>
        </header>

        <div class='chat-area' id='chatArea'>
          <div class='chat-container'>
            <b:section id='main' showaddelement='yes'>
              <b:widget id='Blog1' locked='true' title='Postingan Blog' type='Blog' version='2' visible='true'>
                <b:widget-settings>
                  <b:widget-setting name='showDateHeader'>false</b:widget-setting>
                  <b:widget-setting name='style.textcolor'>#ffffff</b:widget-setting>
                  <b:widget-setting name='showShareButtons'>false</b:widget-setting>
                  <b:widget-setting name='showCommentLink'>false</b:widget-setting>
                  <b:widget-setting name='style.urlcolor'>#ffffff</b:widget-setting>
                  <b:widget-setting name='showAuthor'>false</b:widget-setting>
                  <b:widget-setting name='style.linkcolor'>#ffffff</b:widget-setting>
                  <b:widget-setting name='style.unittype'>TextAndImage</b:widget-setting>
                  <b:widget-setting name='style.bgcolor'>#ffffff</b:widget-setting>
                  <b:widget-setting name='reactionsLabel'/>
                  <b:widget-setting name='showAuthorProfile'>false</b:widget-setting>
                  <b:widget-setting name='style.layout'>1x1</b:widget-setting>
                  <b:widget-setting name='showLabels'>false</b:widget-setting>
                  <b:widget-setting name='showLocation'>false</b:widget-setting>
                  <b:widget-setting name='showTimestamp'>false</b:widget-setting>
                  <b:widget-setting name='postsPerAd'>1</b:widget-setting>
                  <b:widget-setting name='showBacklinks'>false</b:widget-setting>
                  <b:widget-setting name='style.bordercolor'>#ffffff</b:widget-setting>
                  <b:widget-setting name='showInlineAds'>false</b:widget-setting>
                  <b:widget-setting name='showReactions'>false</b:widget-setting>
                </b:widget-settings>
                <b:includable id='main'>
                  <b:if cond='data:posts.notEmpty'>
                    <b:loop values='data:posts' var='post'>
                      <article class='post-outer'>
                        <div class='msg'>
                          <div class='msg-avatar ai'><div class='atom-mini'><div class='atom-nucleus'/><div class='atom-orbit orbit-1'/></div></div>
                          <div class='msg-body'>
                            <div class='msg-header'><span class='msg-name'>Santrilogy AI</span></div>
                            <div class='post-body'><data:post.body/></div>
                          </div>
                        </div>
                      </article>
                    </b:loop>
                  <b:else/>
                    <div class='welcome'>
                      <div class='welcome-logo'>
                        <div class='welcome-glow'/>
                        <div class='atom-logo atom-lg'>
                          <div class='atom-nucleus'/><div class='atom-orbit orbit-1'/><div class='atom-orbit orbit-2'/><div class='atom-orbit orbit-3'/>
                        </div>
                      </div>
                      <h1>Santrilogy AI</h1>
                      <p>Hallo, saya Santrilogy AI. Mau diskusi apa hari ini?</p>
                    </div>
                  </b:if>
                </b:includable>
                <b:includable id='aboutPostAuthor'>
  <div class='author-name'>
    <a class='g-profile' expr:href='data:post.author.profileUrl' rel='author' title='author profile'>
      <span>
        <data:post.author.name/>
      </span>
    </a>
  </div>
  <div>
    <span class='author-desc'>
      <data:post.author.aboutMe/>
    </span>
  </div>
</b:includable>
                <b:includable id='addComments'>
  <a expr:href='data:post.commentsUrl' expr:onclick='data:post.commentsUrlOnclick'>
    <b:message name='messages.postAComment'/>
  </a>
</b:includable>
                <b:includable id='blogThisShare'>
  <b:with value='&quot;window.open(this.href, \&quot;_blank\&quot;, \&quot;height=270,width=475\&quot;); return false;&quot;' var='onclick'>
    <b:include name='platformShare'/>
  </b:with>
</b:includable>
                <b:includable id='bylineByName' var='byline'>
  <b:switch var='data:byline.name'>
  <b:case value='share'/>
    <b:include cond='data:post.shareUrl' name='postShareButtons'/>
  <b:case value='comments'/>
    <b:include cond='data:post.allowComments' name='postCommentsLink'/>
  <b:case value='location'/>
    <b:include cond='data:post.location' name='postLocation'/>
  <b:case value='timestamp'/>
    <b:include cond='not data:view.isPage' name='postTimestamp'/>
  <b:case value='author'/>
    <b:include name='postAuthor'/>
  <b:case value='labels'/>
    <b:include cond='data:post.labels' name='postLabels'/>
  <b:case value='icons'/>
    <b:include cond='data:post.emailPostUrl' name='emailPostIcon'/>
  </b:switch>
</b:includable>
                <b:includable id='bylineRegion' var='regionItems'>
  <b:loop values='data:regionItems' var='byline'>
    <b:include data='byline' name='bylineByName'/>
  </b:loop>
</b:includable>
                <b:includable id='commentAuthorAvatar'>
  <div class='avatar-image-container'>
    <img class='author-avatar' expr:src='data:comment.authorAvatarSrc' height='35' width='35'/>
  </div>
</b:includable>
                <b:includable id='commentDeleteIcon' var='comment'>
  <span expr:class='&quot;item-control &quot; + data:comment.adminClass'>
    <b:if cond='data:showCmtPopup'>
      <div class='goog-toggle-button'>
        <div class='goog-inline-block comment-action-icon'/>
      </div>
    <b:else/>
      <a class='comment-delete' expr:href='data:comment.deleteUrl' expr:title='data:messages.deleteComment'>
        <img src='https://resources.blogblog.com/img/icon_delete13.gif'/>
      </a>
    </b:if>
  </span>
</b:includable>
                <b:includable id='commentForm' var='post'>
  <div class='comment-form'>
    <a name='comment-form'/>
    <h4 id='comment-post-message'><data:messages.postAComment/></h4>
    <b:if cond='data:this.messages.blogComment != &quot;&quot;'>
      <p><data:this.messages.blogComment/></p>
    </b:if>
    <b:include data='post' name='commentFormIframeSrc'/>
    <iframe allowtransparency='allowtransparency' class='blogger-iframe-colorize blogger-comment-from-post' expr:height='data:cmtIframeInitialHeight ?: &quot;90px&quot;' frameborder='0' id='comment-editor' name='comment-editor' src='' width='100%'/>
    <data:post.cmtfpIframe/>
    <script type='text/javascript'>
      BLOG_CMT_createIframe(&#39;<data:post.appRpcRelayPath/>&#39;);
    </script>
  </div>
</b:includable>
                <b:includable id='commentFormIframeSrc' var='post'>
  <a expr:href='data:post.commentFormIframeSrc' id='comment-editor-src'/>
</b:includable>
                <b:includable id='commentItem' var='comment'>
  <div class='comment' expr:id='&quot;c&quot; + data:comment.id'>
    <b:include cond='data:blog.enabledCommentProfileImages' name='commentAuthorAvatar'/>

    <div class='comment-block'>
      <div class='comment-author'>
        <b:if cond='data:comment.authorUrl'>
          <b:message name='messages.authorSaidWithLink'>
            <b:param expr:value='data:comment.author' name='authorName'/>
            <b:param expr:value='data:comment.authorUrl' name='authorUrl'/>
          </b:message>
        <b:else/>
          <b:message name='messages.authorSaid'>
            <b:param expr:value='data:comment.author' name='authorName'/>
          </b:message>
        </b:if>
      </div>
      <div expr:class='&quot;comment-body&quot; + (data:comment.isDeleted ? &quot; deleted&quot; : &quot;&quot;)'>
        <data:comment.body/>
      </div>
      <div class='comment-footer'>
        <span class='comment-timestamp'>
          <a expr:href='data:comment.url' title='comment permalink'>
            <data:comment.timestamp/>
          </a>
          <b:include data='comment' name='commentDeleteIcon'/>
        </span>
      </div>
    </div>
  </div>
</b:includable>
                <b:includable id='commentList' var='comments'>
  <div id='comments-block'>
    <b:loop values='data:comments' var='comment'>
      <b:include data='comment' name='commentItem'/>
    </b:loop>
  </div>
</b:includable>
                <b:includable id='commentPicker' var='post'>
  <b:if cond='data:post.showThreadedComments'>
    <b:include data='post' name='threadedComments'/>
  <b:else/>
    <b:include data='post' name='comments'/>
  </b:if>
</b:includable>
                <b:includable id='comments' var='post'>
  <section expr:class='&quot;comments&quot; + (data:post.embedCommentForm ? &quot; embed&quot; : &quot;&quot;)' expr:data-num-comments='data:post.numberOfComments' id='comments'>
    <a name='comments'/>
    <b:if cond='data:post.allowComments'>

      <b:include name='commentsTitle'/>

      <div expr:id='data:widget.instanceId + &quot;_comments-block-wrapper&quot;'>
        <b:include cond='data:post.comments' data='post.comments' name='commentList'/>
      </div>

      <b:if cond='data:post.commentPagingRequired'>
        <div class='paging-control-container'>
          <b:if cond='data:post.hasOlderLinks'>
            <a expr:class='data:post.oldLinkClass' expr:href='data:post.oldestLinkUrl'>
              <data:messages.oldest/>
            </a>
            <a expr:class='data:post.oldLinkClass' expr:href='data:post.olderLinkUrl'>
              <data:messages.older/>
            </a>
          </b:if>

          <span class='comment-range-text'>
            <data:post.commentRangeText/>
          </span>

          <b:if cond='data:post.hasNewerLinks'>
            <a expr:class='data:post.newLinkClass' expr:href='data:post.newerLinkUrl'>
              <data:messages.newer/>
            </a>
            <a expr:class='data:post.newLinkClass' expr:href='data:post.newestLinkUrl'>
              <data:messages.newest/>
            </a>
          </b:if>
        </div>
      </b:if>

      <div class='footer'>
        <b:if cond='data:post.embedCommentForm'>
          <b:if cond='data:post.allowNewComments'>
            <b:include data='post' name='commentForm'/>
          <b:else/>
            <data:post.noNewCommentsText/>
          </b:if>
        <b:else/>
          <b:if cond='data:post.allowComments'>
            <b:include data='post' name='addComments'/>
          </b:if>
        </b:if>
      </div>
    </b:if>
    <b:if cond='data:showCmtPopup'>
      <div id='comment-popup'>
        <iframe allowtransparency='allowtransparency' frameborder='0' id='comment-actions' name='comment-actions' scrolling='no'>
        </iframe>
      </div>
    </b:if>
  </section>
</b:includable>
                <b:includable id='commentsLink'>
  <a class='comment-link' expr:href='data:post.commentsUrl' expr:onclick='data:post.commentsUrlOnclick'>
    <b:if cond='data:post.numberOfComments &gt; 0'>
      <b:message name='messages.numberOfComments'>
        <b:param expr:value='data:post.numberOfComments' name='numComments'/>
      </b:message>
    <b:else/>
      <data:messages.postAComment/>
    </b:if>
  </a>
</b:includable>
                <b:includable id='commentsLinkIframe'>
  <!-- G+ comments, no longer available. The includable is retained for backwards-compatibility. -->
</b:includable>
                <b:includable id='commentsTitle'>
  <h3 class='title'><data:messages.comments/></h3>
</b:includable>
                <b:includable id='defaultAdUnit'>
  <ins class='adsbygoogle' data-ad-format='auto' expr:data-ad-client='data:adClientId ?: data:blog.adsenseClientId' expr:data-ad-host='data:blog.adsenseHostId' expr:style='data:style ?: &quot;display: block;&quot;'>
    <b:attr cond='not data:blog.analytics4' expr:value='data:blog.analyticsAccountNumber' name='data-analytics-uacct'/>
  </ins>
  <script>
   (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</b:includable>
                <b:includable id='emailPostIcon'>
  <span class='byline post-icons'>
    <!-- email post links -->
    <span class='item-action'>
      <a expr:href='data:post.emailPostUrl' expr:title='data:messages.emailPost'>
        <b:include data='{ iconClass: &quot;touch-icon sharing-icon&quot; }' name='emailIcon'/>
      </a>
    </span>
  </span>
</b:includable>
                <b:includable id='facebookShare'>
  <b:with value='&quot;window.open(this.href, \&quot;_blank\&quot;, \&quot;height=430,width=640\&quot;); return false;&quot;' var='onclick'>
    <b:include name='platformShare'/>
  </b:with>
</b:includable>
                <b:includable id='feedLinks'>
  <b:if cond='!data:view.isPost'> <!-- Blog feed links -->
    <b:if cond='data:feedLinks'>
      <div class='blog-feeds'>
        <b:include data='feedLinks' name='feedLinksBody'/>
      </div>
    </b:if>
  <b:else/> <!--Post feed links -->
    <div class='post-feeds'>
      <b:loop values='data:posts' var='post'>
        <b:if cond='data:post.allowComments and data:post.feedLinks'>
          <b:include data='post.feedLinks' name='feedLinksBody'/>
        </b:if>
      </b:loop>
    </div>
  </b:if>
</b:includable>
                <b:includable id='feedLinksBody' var='links'>
  <div class='feed-links'>
  <data:messages.subscribeTo/>
  <b:loop values='data:links' var='f'>
     <a class='feed-link' expr:href='data:f.url' expr:type='data:f.mimeType' target='_blank'><data:f.name/> (<data:f.feedType/>)</a>
  </b:loop>
  </div>
</b:includable>
                <b:includable id='footerBylines'>
  <b:if cond='data:widgets.Blog.first.footerBylines'>
    <b:loop index='i' values='data:widgets.Blog.first.footerBylines' var='region'>
      <b:if cond='not data:region.items.empty'>
        <div expr:class='&quot;post-footer-line post-footer-line-&quot; + (data:i + 1)'>
          <b:with value='&quot;footer-&quot; + (data:i + 1)' var='regionName'>
            <b:include data='region.items' name='bylineRegion'/>
          </b:with>
        </div>
      </b:if>
    </b:loop>
  </b:if>
</b:includable>
                <b:includable id='googlePlusShare'>
</b:includable>
                <b:includable id='headerByline'>
  <b:if cond='data:widgets.Blog.first.headerByline'>
    <div class='post-header'>
      <div class='post-header-line-1'>
        <b:with value='&quot;header-1&quot;' var='regionName'>
          <b:include data='data:widgets.Blog.first.headerByline.items' name='bylineRegion'/>
        </b:with>
      </div>
    </div>
  </b:if>
</b:includable>
                <b:includable id='homePageLink'>
  <a class='home-link' expr:href='data:blog.homepageUrl'>
    <data:messages.home/>
  </a>
</b:includable>
                <b:includable id='iframeComments' var='post'>
  <!-- G+ comments, no longer available. The includable is retained for backwards-compatibility. -->
</b:includable>
                <b:includable id='inlineAd' var='post'>
  <b:if cond='!data:view.isPreview'>
    <b:if cond='data:this.adCode or data:this.adClientId or data:blog.adsenseClientId'>
      <!-- Ad -->
      <div class='inline-ad'>
        <b:if cond='data:this.adCode != &quot;&quot;'>
          <data:this.adCode/>
        <b:else/>
          <b:include cond='data:this.adClientId or data:blog.adsenseClientId' name='defaultAdUnit'/>
        </b:if>
      </div>
    </b:if>
  <b:else/>
    <div class='inline-ad'>
      <div class='inline-ad-placeholder'>
        <span><b:message name='messages.adsGoHere'/></span>
      </div>
    </div>
  </b:if>
</b:includable>
                <b:includable id='linkShare'>
  <b:with value='&quot;window.prompt(\&quot;Copy to clipboard: Ctrl+C, Enter\&quot;, \&quot;&quot; + data:originalUrl + &quot;\&quot;); return false;&quot;' var='onclick'>
    <b:include name='platformShare'/>
  </b:with>
</b:includable>
                <b:includable id='nextPageLink'>
  <a class='blog-pager-older-link' expr:href='data:olderPageUrl' expr:id='data:widget.instanceId + &quot;_blog-pager-older-link&quot;' expr:title='data:messages.olderPosts'>
    <data:messages.olderPosts/>
  </a>
</b:includable>
                <b:includable id='otherSharingButton'>
  <span class='sharing-platform-button sharing-element-other' expr:aria-label='data:messages.shareToOtherApps.escaped' expr:data-url='data:originalUrl' expr:title='data:messages.shareToOtherApps.escaped' role='menuitem' tabindex='-1'>
    <b:with value='{key: &quot;sharingOther&quot;}' var='platform'>
      <b:include name='sharingPlatformIcon'/>
    </b:with>
    <span class='platform-sharing-text'><data:messages.shareOtherApps.escaped/></span>
  </span>
</b:includable>
                <b:includable id='platformShare'>
  <a expr:class='&quot;goog-inline-block sharing-&quot; + data:platform.key' expr:data-url='data:originalUrl' expr:href='data:shareUrl + &quot;&amp;target=&quot; + data:platform.target' expr:onclick='data:onclick ? data:onclick : &quot;&quot;' expr:title='data:platform.shareMessage' target='_blank'>
    <span class='share-button-link-text'>
      <data:platform.shareMessage/>
    </span>
  </a>
</b:includable>
                <b:includable id='post' var='post'>
  <div class='post'>
    <b:include data='post' name='postMeta'/>
    <b:include data='post' name='postTitle'/>
    <b:include name='headerByline'/>
    <b:if cond='data:view.isSingleItem'>
      <b:include data='post' name='postBody'/>
    <b:else/>
      <b:include data='post' name='postBodySnippet'/>
      <b:include data='post' name='postJumpLink'/>
    </b:if>
    <b:include data='post' name='postFooter'/>
  </div>
</b:includable>
                <b:includable id='postAuthor'>
  <span class='byline post-author vcard'>
    <span class='post-author-label'>
      <data:byline.label/>
    </span>
    <span class='fn'>
      <b:if cond='data:post.author.profileUrl'>
        <meta expr:content='data:post.author.profileUrl'/>
        <a class='g-profile' expr:href='data:post.author.profileUrl' rel='author' title='author profile'>
          <span><data:post.author.name/></span>
        </a>
      <b:else/>
        <span><data:post.author.name/></span>
      </b:if>
    </span>
  </span>
</b:includable>
                <b:includable id='postBody' var='post'>
  <!-- If metaDescription is empty, use the post body as the schema.org description too, for G+/FB snippeting. -->
  <div class='post-body entry-content float-container' expr:id='&quot;post-body-&quot; + data:post.id'>
    <data:post.body/>
  </div>
</b:includable>
                <b:includable id='postBodySnippet' var='post'>
  <b:include data='post' name='postBody'/>
</b:includable>
                <b:includable id='postCommentsAndAd' var='post'>
  <article class='post-outer-container'>
    <!-- Post title and body -->
    <div class='post-outer'>
      <b:include data='post' name='post'/>
    </div>

    <!-- Comments -->
    <b:include cond='data:view.isSingleItem' data='post' name='commentPicker'/>

    <!-- Show ad inside post container, after comments, if single item. -->
    <b:include cond='data:view.isSingleItem and data:post.includeAd' data='post' name='inlineAd'/>
  </article>

  <!-- Show ad outside post container (between posts) for feed pages. -->
  <b:include cond='data:view.isMultipleItems and data:post.includeAd' data='post' name='inlineAd'/>
</b:includable>
                <b:includable id='postCommentsLink'>
  <b:if cond='data:view.isMultipleItems'>
    <span class='byline post-comment-link container'>
      <b:include cond='data:post.commentSource != 1' name='commentsLink'/>
    </span>
  </b:if>
</b:includable>
                <b:includable id='postFooter' var='post'>
  <div class='post-footer'>
    <b:include name='footerBylines'/>
    <b:include data='post' name='postFooterAuthorProfile'/>
  </div>
</b:includable>
                <b:includable id='postFooterAuthorProfile' var='post'>
  <b:if cond='data:post.author.aboutMe and data:view.isPost'>
    <div class='author-profile'>
      <b:if cond='data:post.author.authorPhoto.url'>
        <img class='author-image' expr:src='data:post.author.authorPhoto.url' width='50px'/>
        <div class='author-about'>
          <b:include data='post' name='aboutPostAuthor'/>
        </div>
      <b:else/>
        <b:include data='post' name='aboutPostAuthor'/>
      </b:if>
    </div>
  </b:if>
</b:includable>
                <b:includable id='postHeader' var='post'>
  <b:include name='headerByline'/>
</b:includable>
                <b:includable id='postJumpLink' var='post'>
  <div class='jump-link flat-button'>
    <a expr:href='data:post.url fragment &quot;more&quot;' expr:title='data:post.title'>
      <b:eval expr='data:blog.jumpLinkMessage'/>
    </a>
  </div>
</b:includable>
                <b:includable id='postLabels'>
  <span class='byline post-labels'>
    <span class='byline-label'><data:byline.label/></span>
    <b:loop index='i' values='data:post.labels' var='label'>
      <a expr:href='data:label.url' rel='tag'>
        <data:label.name/>
      </a>
    </b:loop>
  </span>
</b:includable>
                <b:includable id='postLocation'>
  <span class='byline post-location'>
    <data:byline.label/>
    <a expr:href='data:post.location.mapsUrl' target='_blank'><data:post.location.name/></a>
  </span>
</b:includable>
                <b:includable id='postMeta' var='post'>
  <b:include data='post' name='postMetadataJSON'/>
</b:includable>
                <b:includable id='postMetadataJSONImage'>
  &quot;image&quot;: {
    &quot;@type&quot;: &quot;ImageObject&quot;,
    <b:if cond='data:post.featuredImage.isResizable'>
    &quot;url&quot;: &quot;<b:eval expr='resizeImage(data:post.featuredImage, 1200, &quot;1200:630&quot;)'/>&quot;,
    &quot;height&quot;: 630,
    &quot;width&quot;: 1200
    <b:else/>
    &quot;url&quot;: &quot;https://blogger.googleusercontent.com/img/b/U2hvZWJveA/AVvXsEgfMvYAhAbdHksiBA24JKmb2Tav6K0GviwztID3Cq4VpV96HaJfy0viIu8z1SSw_G9n5FQHZWSRao61M3e58ImahqBtr7LiOUS6m_w59IvDYwjmMcbq3fKW4JSbacqkbxTo8B90dWp0Cese92xfLMPe_tg11g/w1200/&quot;,
    &quot;height&quot;: 348,
    &quot;width&quot;: 1200
    </b:if>
  },
</b:includable>
                <b:includable id='postMetadataJSONPublisher'>
 &quot;publisher&quot;: {
    &quot;@type&quot;: &quot;Organization&quot;,
    &quot;name&quot;: &quot;Blogger&quot;,
    &quot;logo&quot;: {
      &quot;@type&quot;: &quot;ImageObject&quot;,
      &quot;url&quot;: &quot;https://blogger.googleusercontent.com/img/b/U2hvZWJveA/AVvXsEgfMvYAhAbdHksiBA24JKmb2Tav6K0GviwztID3Cq4VpV96HaJfy0viIu8z1SSw_G9n5FQHZWSRao61M3e58ImahqBtr7LiOUS6m_w59IvDYwjmMcbq3fKW4JSbacqkbxTo8B90dWp0Cese92xfLMPe_tg11g/h60/&quot;,
      &quot;width&quot;: 206,
      &quot;height&quot;: 60
    }
  },
</b:includable>
                <b:includable id='postPagination'>
  <div class='blog-pager container' id='blog-pager'>
    <b:include cond='data:newerPageUrl' name='previousPageLink'/>
    <b:include cond='data:olderPageUrl' name='nextPageLink'/>
    <b:include cond='data:view.url != data:blog.homepageUrl' name='homePageLink'/>
  </div>
</b:includable>
                <b:includable id='postReactions'>
  <!-- Reaction feature no longer available. The includable is retained for backwards-compatibility. -->
</b:includable>
                <b:includable id='postShareButtons'>
  <div class='byline post-share-buttons goog-inline-block'>
    <b:with value='data:sharingId ?: ((data:widget.instanceId ?: &quot;sharing&quot;) + &quot;-&quot; + (data:regionName ?: &quot;byline&quot;) + &quot;-&quot; + data:post.id)' var='sharingId'>
      <!-- Note: 'sharingButtons' includable is from the default Sharing widget markup. -->
      <b:include data='{                                                sharingId: data:sharingId,                                                originalUrl: data:post.url,                                                platforms: data:this.sharing.platforms,                                                shareUrl: data:post.shareUrl,                                                shareTitle: data:post.title,                                              }' name='sharingButtons'/>
    </b:with>
  </div>
</b:includable>
                <b:includable id='postTimestamp'>
  <span class='byline post-timestamp'>
    <data:byline.label/>
    <b:if cond='data:post.url'>
      <meta expr:content='data:post.url.canonical'/>
      <a class='timestamp-link' expr:href='data:post.url' rel='bookmark' title='permanent link'>
        <time class='published' expr:datetime='data:post.date.iso8601' expr:title='data:post.date.iso8601'>
          <data:post.date/>
        </time>
      </a>
    </b:if>
  </span>
</b:includable>
                <b:includable id='postTitle' var='post'>
  <a expr:name='data:post.id'/>
  <b:if cond='data:post.title != &quot;&quot;'>
    <h3 class='post-title entry-title'>
      <b:if cond='data:post.link or (data:post.url and data:view.url != data:post.url)'>
        <a expr:href='data:post.link ?: data:post.url'><data:post.title/></a>
      <b:else/>
        <data:post.title/>
      </b:if>
    </h3>
  </b:if>
</b:includable>
                <b:includable id='previousPageLink'>
  <a class='blog-pager-newer-link' expr:href='data:newerPageUrl' expr:id='data:widget.instanceId + &quot;_blog-pager-newer-link&quot;' expr:title='data:messages.newerPosts'>
    <data:messages.newerPosts/>
  </a>
</b:includable>
                <b:includable id='sharingButton'>
  <span expr:aria-label='data:platform.shareMessage' expr:class='&quot;sharing-platform-button sharing-element-&quot; + data:platform.key' expr:data-href='data:shareUrl + &quot;&amp;target=&quot; + data:platform.target' expr:data-url='data:originalUrl' expr:title='data:platform.shareMessage' role='menuitem' tabindex='-1'>
    <b:include name='sharingPlatformIcon'/>
    <span class='platform-sharing-text'><data:platform.name/></span>
  </span>
</b:includable>
                <b:includable id='sharingButtonContent'>
  <div class='flat-icon-button ripple'>
    <b:include name='shareIcon'/>
  </div>
</b:includable>
                <b:includable id='sharingButtons'>
  <div class='sharing' expr:aria-owns='&quot;sharing-popup-&quot; + data:sharingId' expr:data-title='data:shareTitle'>
    <button class='sharing-button touch-icon-button' expr:aria-controls='&quot;sharing-popup-&quot; + data:sharingId' expr:aria-label='data:messages.share.escaped' expr:id='&quot;sharing-button-&quot; + data:sharingId' role='button'>
      <b:include name='sharingButtonContent'/>
    </button>
    <b:include name='sharingButtonsMenu'/>
  </div>
</b:includable>
                <b:includable id='sharingButtonsMenu'>
  <div class='share-buttons-container'>
    <ul aria-hidden='true' class='share-buttons hidden' expr:aria-label='data:messages.share.escaped' expr:id='&quot;sharing-popup-&quot; + data:sharingId' role='menu'>
      <b:loop values='(data:platforms ?: data:blog.sharing.platforms) filter (p =&gt; p.key not in {&quot;blogThis&quot;})' var='platform'>
        <li>
          <b:include name='sharingButton'/>
        </li>
      </b:loop>
      <li aria-hidden='true' class='hidden'>
        <b:include name='otherSharingButton'/>
      </li>
    </ul>
  </div>
</b:includable>
                <b:includable id='sharingPlatformIcon'>
  <b:include data='{ iconClass: (&quot;touch-icon sharing-&quot; + data:platform.key) }' expr:name='data:platform.key + &quot;Icon&quot;'/>
</b:includable>
                <b:includable id='threadedCommentForm' var='post'>
  <div class='comment-form'>
    <a name='comment-form'/>
    <h4 id='comment-post-message'><data:messages.postAComment/></h4>
    <b:if cond='data:this.messages.blogComment != &quot;&quot;'>
      <p><data:this.messages.blogComment/></p>
    </b:if>
    <b:include data='post' name='commentFormIframeSrc'/>
    <iframe allowtransparency='allowtransparency' class='blogger-iframe-colorize blogger-comment-from-post' expr:height='data:cmtIframeInitialHeight ?: &quot;90px&quot;' frameborder='0' id='comment-editor' name='comment-editor' src='' width='100%'/>
    <data:post.cmtfpIframe/>
    <script type='text/javascript'>
      BLOG_CMT_createIframe(&#39;<data:post.appRpcRelayPath/>&#39;);
    </script>
  </div>
</b:includable>
                <b:includable id='threadedCommentJs' var='post'>
  <script async='async' expr:src='data:post.commentSrc' type='text/javascript'/>
  <b:template-script inline='true' name='threaded_comments'/>
  <script type='text/javascript'>
    blogger.widgets.blog.initThreadedComments(
        <data:post.commentJso/>,
        <data:post.commentMsgs/>,
        <data:post.commentConfig/>);
  </script>
</b:includable>
                <b:includable id='threadedComments' var='post'>
  <section class='comments threaded' expr:data-embed='data:post.embedCommentForm' expr:data-num-comments='data:post.numberOfComments' id='comments'>
    <a name='comments'/>

    <b:include name='commentsTitle'/>

    <div class='comments-content'>
      <b:if cond='data:post.embedCommentForm'>
        <b:include data='post' name='threadedCommentJs'/>
      </b:if>
      <div id='comment-holder'>
         <data:post.commentHtml/>
      </div>
    </div>

    <p class='comment-footer'>
      <b:if cond='data:post.allowNewComments'>
        <b:include data='post' name='threadedCommentForm'/>
      <b:else/>
        <data:post.noNewCommentsText/>
      </b:if>
      <b:if cond='data:post.showManageComments'>
        <b:include data='post' name='manageComments'/>
      </b:if>
    </p>

    <b:if cond='data:showCmtPopup'>
      <div id='comment-popup'>
        <iframe allowtransparency='allowtransparency' frameborder='0' id='comment-actions' name='comment-actions' scrolling='no'>
        </iframe>
      </div>
    </b:if>
  </section>
</b:includable>
                <b:includable id='tooltipCss'>
  <!-- LINT.IfChange -->
  <style>
    .post-body a.b-tooltip-container {
      position: relative;
      display: inline-block;
    }

    .post-body a.b-tooltip-container .b-tooltip {
      display: block !important;
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translate(-20%, 1px);
      visibility: hidden;
      opacity: 0;
      z-index: 1;
      transition: opacity 0.2s ease-in-out;
    }

    .post-body a.b-tooltip-container .b-tooltip iframe {
      width: 200px;
      height: 198px;
      max-width: none;
      border: none;
      border-radius: 20px;
      box-shadow: 1px 1px 3px 1px rgba(0, 0, 0, 0.2);
    }

    @media (hover: hover) {
      .post-body a.b-tooltip-container:hover .b-tooltip {
        visibility: visible;
        opacity: 1;
      }
    }
  </style>
  <!-- LINT.ThenChange(//depot/google3/java/com/google/blogger/b2/layouts/widgets/v2-style.css) -->
</b:includable>
              </b:widget>
            </b:section>
          </div>
        </div>

        <div class='input-area'>
          <div class='input-wrap'>
            
            <div class='tools-dropdown' id='toolsDropdown'>
               <div class='dropdown-section'>
                  <div class='dropdown-label'>Smart Tools</div>
                  <div class='tool-item' onclick='useTool(&quot;terjemah&quot;)'><i class='fas fa-language'/><span>Terjemah Kitab</span></div>
               </div>
            </div>

            <div class='input-box'>
              <div class='input-left'>
                <button class='input-btn plus' id='plusBtn' title='Tools'>
                  <i class='fas fa-plus-circle'/>
                </button>
              </div>
              
              <textarea class='input-field' id='userPrompt' oninput='handleInput()' onkeydown='handleKeyDown(event)' placeholder='Tanyakan sesuatu...' rows='1'/>
              
              <div class='input-right'>
                <button class='send-mic-btn mic' id='actionBtn' onclick='handleSendMic()'>
                  <i class='fas fa-microphone' id='actionIcon'/>
                </button>
              </div>
            </div>
            <p class='input-footer'>Santrilogy AI bisa keliru. Verifikasi ke ustadz.</p>
          </div>
        </div>
      </div>
    </div>

    <div class='modal-overlay mobile-overlay' id='toolsOverlay' onclick='closeToolsModal()'/>
    <div class='mobile-modal' id='toolsModal'>
       </div>

    <input id='customColorPicker' onchange='applyCustomColor(this.value)' style='display: none;' type='color'/>

    <script>
      /*<![CDATA[*/
      function openColorPicker() {
        // On mobile devices, the input type="color" should work consistently
        document.getElementById('customColorPicker').click();
      }

      function applyCustomColor(color) {
        // Update --accent variable
        document.documentElement.style.setProperty('--accent', color);

        // Generate a complementary color for --accent-2
        const accent2 = calculateComplementaryColor(color);
        document.documentElement.style.setProperty('--accent-2', accent2);

        // Update --gradient-1 based on the custom color
        const gradient = `linear-gradient(135deg, ${color} 0%, ${accent2} 50%, #06b6d4 100%)`;
        document.documentElement.style.setProperty('--gradient-1', gradient);

        // Update data-accent attribute on body to track custom theme
        document.body.setAttribute('data-accent', 'custom');

        // Remove active class from all color pills and add it to custom
        const colorPills = document.querySelectorAll('.color-pill, .mobile-color-btn');
        colorPills.forEach(pill => {
          pill.classList.remove('active');
        });

        // Find and activate the custom color pill
        const customColorPill = document.querySelector('.c-custom, .mobile-color-btn[onclick*="openColorPicker"]');
        if (customColorPill) {
          customColorPill.classList.add('active');
        }
      }

      function calculateComplementaryColor(color) {
        // Convert hex to RGB
        let r = 0, g = 0, b = 0;
        if (color.length === 7) {
          r = parseInt(color.substring(1, 3), 16);
          g = parseInt(color.substring(3, 5), 16);
          b = parseInt(color.substring(5, 7), 16);
        }

        // Generate a complementary color by adjusting RGB values
        r = Math.min(255, r + 50);
        g = Math.min(255, g + 30);
        b = Math.min(255, b + 70);

        // Ensure the color is not too light
        if (r > 220 && g > 220 && b > 220) {
          r = Math.max(0, r - 100);
          g = Math.max(0, g - 100);
          b = Math.max(0, b - 100);
        }

        return `rgb(${r}, ${g}, ${b})`;
      }

      // Voice recognition variables
      let recognition;
      let isListening = false;

      // Initialize Speech Recognition if browser supports it
      function initSpeechRecognition() {
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
          const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
          recognition = new SpeechRecognition();
          recognition.continuous = false;
          recognition.interimResults = true;
          recognition.lang = 'id-ID'; // Set to Indonesian language
          recognition.maxAlternatives = 1;

          recognition.onresult = function(event) {
            let transcript = '';
            for (let i = 0; i < event.results.length; i++) {
              if (event.results[i].isFinal) {
                transcript = event.results[i][0].transcript;
              } else {
                transcript += event.results[i][0].transcript;
              }
            }
            document.getElementById('userPrompt').value = transcript;
          };

          recognition.onerror = function(event) {
            console.error('Speech recognition error', event.error);
            stopListening();
          };

          recognition.onend = function() {
            // Don't automatically stop listening - let the user decide
            // For mobile, we might need to restart in some cases
            if (isListening) {
              // On some mobile browsers, we need to restart recognition for continuous use
              setTimeout(() => {
                if (isListening && recognition) {
                  try {
                    recognition.start();
                  } catch (e) {
                    console.log('Could not restart recognition:', e);
                    stopListening();
                  }
                }
              }, 100);
            }
          };
        } else {
          alert('Browser Anda tidak mendukung fitur Speech Recognition. Silakan gunakan browser modern seperti Chrome.');
          stopListening();
        }
      }

      // Function to start voice recording
      function startVoice() {
        if (!recognition) {
          initSpeechRecognition();
        }

        if (recognition) {
          try {
            document.getElementById('actionBtn').innerHTML = '<i class="fas fa-circle"/>';
            document.getElementById('actionBtn').classList.remove('mic');
            document.getElementById('actionBtn').classList.add('send');
            recognition.start();
            isListening = true;
          } catch (error) {
            console.error('Error starting recognition:', error);
            // Mobile Safari and some other mobile browsers may require user gesture to enable speech recognition
            if (error.message && error.message.includes('no-speech')) {
              alert('Silakan ucapkan sesuatu. Jika tidak berfungsi, pastikan izin mikrofon telah diberikan.');
            }
            stopListening();
          }
        }
      }

      // Function to stop voice recording
      function stopListening() {
        if (recognition && isListening) {
          try {
            recognition.stop();
          } catch (e) {
            console.log('Recognition stop error:', e);
          }
          document.getElementById('actionBtn').innerHTML = '<i class="fas fa-microphone"/>';
          document.getElementById('actionBtn').classList.remove('send');
          document.getElementById('actionBtn').classList.add('mic');
          isListening = false;
        }
      }

      // Toggle voice recording
      function handleSendMic() {
        if (!isListening) {
          startVoice();
        } else {
          stopListening();
        }
      }

      // Initialize speech recognition on page load
      document.addEventListener('DOMContentLoaded', function() {
        initSpeechRecognition();
      });

      // More dropdown functions
      function toggleMoreDropdown() {
        const dropdown = document.getElementById('moreDropdown');
        const isVisible = dropdown.classList.contains('show');

        if (isVisible) {
          closeMoreDropdown();
        } else {
          dropdown.classList.add('show');
          // Close dropdown when clicking outside
          setTimeout(() => {
            document.addEventListener('click', closeMoreDropdownOnClickOutside);
          }, 10);
        }
      }

      function closeMoreDropdown() {
        const dropdown = document.getElementById('moreDropdown');
        dropdown.classList.remove('show');
        document.removeEventListener('click', closeMoreDropdownOnClickOutside);
      }

      function closeMoreDropdownOnClickOutside(event) {
        const dropdown = document.getElementById('moreDropdown');
        const moreBtn = document.querySelector('[onclick*="toggleMoreDropdown"]');

        if (!dropdown.contains(event.target) && !moreBtn.contains(event.target)) {
          closeMoreDropdown();
        }
      }

      // More menu functions
      function shareCurrentPage() {
        if (navigator.share) {
          navigator.share({
            title: 'Santrilogy AI',
            text: 'Check out Santrilogy AI - Your virtual Islamic study companion',
            url: window.location.href
          }).catch(console.error);
        } else {
          // Fallback: Copy to clipboard
          navigator.clipboard.writeText(window.location.href).then(() => {
            alert('Link copied to clipboard!');
          });
        }
        closeMoreDropdown();
      }

      function downloadApp() {
        alert('Download App feature coming soon!');
        closeMoreDropdown();
      }

      function showPrivacyPolicy() {
        alert('Privacy Policy page coming soon!');
        closeMoreDropdown();
      }

      function showTermsConditions() {
        alert('Terms &amp; Conditions page coming soon!');
        closeMoreDropdown();
      }

      // Responsive toggle for tools
      function toggleToolsResponsive() {
        const isMobile = window.innerWidth <= 768;

        if (isMobile) {
          // On mobile, show the mobile modal with slide up animation
          showToolsModal();
        } else {
          // On desktop, toggle the desktop dropdown
          toggleTools();
        }
      }

      // Modified showToolsModal to add swipe gesture support
      function showToolsModal() {
        const modal = document.getElementById('toolsModal');
        const overlay = document.getElementById('toolsOverlay');

        // Show the modal with slide up animation
        modal.classList.add('show');
        overlay.classList.add('show');
        document.body.style.overflow = 'hidden';
      }

      function closeToolsModal() {
        const modal = document.getElementById('toolsModal');
        const overlay = document.getElementById('toolsOverlay');

        modal.classList.remove('show');
        overlay.classList.remove('show');
        document.body.style.overflow = '';
      }

      // Toggle desktop tools dropdown
      function toggleTools() {
        const dropdown = document.getElementById('toolsDropdown');
        const isVisible = dropdown.classList.contains('show');

        if (isVisible) {
          dropdown.classList.remove('show');
        } else {
          dropdown.classList.add('show');
          // Close dropdown when clicking outside
          setTimeout(() => {
            document.addEventListener('click', closeToolsDropdownOnClickOutside);
          }, 10);
        }
      }

      function closeToolsDropdown() {
        document.getElementById('toolsDropdown').classList.remove('show');
        document.removeEventListener('click', closeToolsDropdownOnClickOutside);
      }

      function closeToolsDropdownOnClickOutside(event) {
        const dropdown = document.getElementById('toolsDropdown');
        const plusBtn = document.getElementById('plusBtn');

        if (!dropdown.contains(event.target) && !plusBtn.contains(event.target)) {
          closeToolsDropdown();
        }
      }

      // Setup swipe gesture for mobile modal
      function setupSwipeGesture() {
        const modal = document.getElementById('toolsModal');
        if (!modal) return;

        let startY = 0;
        let currentY = 0;
        let isSwiping = false;

        modal.addEventListener('touchstart', (e) => {
          startY = e.touches[0].clientY;
          isSwiping = true;
        });

        modal.addEventListener('touchmove', (e) => {
          if (!isSwiping) return;

          currentY = e.touches[0].clientY;
          const deltaY = currentY - startY;

          // Only allow swiping down
          if (deltaY > 0) {
            modal.style.transform = `translateY(${deltaY}px)`;
          }
        });

        modal.addEventListener('touchend', (e) => {
          if (!isSwiping) return;

          const deltaY = currentY - startY;
          const threshold = 100; // Minimum distance to close modal

          if (deltaY > threshold) {
            // Swipe down enough to close the modal
            closeToolsModal();
          } else {
            // Reset position
            modal.style.transform = 'translateY(0)';
          }

          isSwiping = false;
        });
      }

      // Theme functions
      function toggleDarkMode() {
        document.body.toggleAttribute('data-theme');
        const isDark = document.body.getAttribute('data-theme') === 'dark';
        if (isDark) {
          document.body.setAttribute('data-theme', 'dark');
        } else {
          document.body.removeAttribute('data-theme');
        }
      }

      function setAccent(element) {
        const accent = element.getAttribute('data-accent');
        document.body.setAttribute('data-accent', accent);

        // Remove active class from all accent elements
        const accentElements = document.querySelectorAll('[data-accent]');
        accentElements.forEach(el => {
          el.classList.remove('active');
        });

        // Add active class to current element
        element.classList.add('active');
      }

      function setFontSize(element) {
        const size = element.getAttribute('data-size');
        document.body.setAttribute('data-fontsize', size);

        // Remove active class from all size elements
        const sizeElements = document.querySelectorAll('[data-size]');
        sizeElements.forEach(el => {
          el.classList.remove('active');
        });

        // Add active class to current element
        element.classList.add('active');
      }

      function clearChats() {
        if (confirm('Apakah Anda yakin ingin menghapus semua percakapan?')) {
          // Remove all chat messages except the welcome screen
          const chatContainer = document.getElementById('main');
          if (chatContainer) {
            chatContainer.innerHTML = '';
          }
        }
      }

      function startNewChat() {
        clearChats();
      }

      function toggleSidebar() {
        const sidebar = document.getElementById('sidebar');
        sidebar.classList.toggle('collapsed');

        // Also update overlay visibility
        const overlay = document.getElementById('overlay');
        overlay.classList.toggle('show', !sidebar.classList.contains('collapsed'));
      }

      function closeSidebar() {
        const sidebar = document.getElementById('sidebar');
        sidebar.classList.add('collapsed');

        // Hide overlay
        const overlay = document.getElementById('overlay');
        overlay.classList.remove('show');
      }

      function askQuestion(question) {
        // Remove welcome screen if present
        const welcomeScreen = document.querySelector('.welcome');
        if (welcomeScreen) {
          welcomeScreen.remove();
        }

        // Populate and send the question
        const input = document.getElementById('userPrompt');
        if (input) {
          input.value = question;

          // Trigger the action handler (which might be in external app.js)
          // We'll call the window function to ensure it's available
          if (window.handleActionClick) {
            handleActionClick();
          }
        }
      }

      function closeSettingsModal() {
        const modal = document.getElementById('settingsModal');
        const overlay = document.getElementById('settingsOverlay');
        if (modal) modal.classList.remove('show');
        if (overlay) overlay.classList.remove('show');
      }

      function toggleSettings() {
        const profileChevron = document.getElementById('profileChevron');
        const settingsDropdown = document.getElementById('settingsDropdown');

        if (settingsDropdown) {
          settingsDropdown.classList.toggle('show');

          // Rotate chevron icon
          if (profileChevron) {
            profileChevron.style.transform = settingsDropdown.classList.contains('show') ? 'rotate(180deg)' : 'rotate(0deg)';
          }
        }
      }

      function closeSettingsDropdown() {
        const settingsDropdown = document.getElementById('settingsDropdown');
        const profileChevron = document.getElementById('profileChevron');

        if (settingsDropdown) {
          settingsDropdown.classList.remove('show');

          // Reset chevron rotation
          if (profileChevron) {
            profileChevron.style.transform = 'rotate(0deg)';
          }
        }
      }

      // Expose functions to window for compatibility with HTML onclick handlers
      window.openColorPicker = openColorPicker;
      window.applyCustomColor = applyCustomColor;
      window.toggleDarkMode = toggleDarkMode;
      window.setAccent = setAccent;
      window.setFontSize = setFontSize;
      window.clearChats = clearChats;
      window.startNewChat = startNewChat;
      window.toggleSidebar = toggleSidebar;
      window.closeSidebar = closeSidebar;
      window.askQuestion = askQuestion;
      window.toggleSettings = toggleSettings;
      window.closeSettingsModal = closeSettingsModal;
      window.closeSettingsDropdown = closeSettingsDropdown;
      /*]]>*/
    </script>

    <script src='https://cdn.jsdelivr.net/gh/santrilogyapp/santrilogy-ai@main/optimized-assets/js/app.js'/>
  </body>
</html>