<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>
<html b:css='false' b:defaultwidgetversion='2' b:layoutsVersion='3' b:responsive='true' b:templateUrl='indie.xml' b:templateVersion='1.0.0' expr:dir='data:blog.languageDirection' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
  <head>
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover' name='viewport'/>
    <!-- Legacy Apple meta tag (deprecated) -->
    <meta content='yes' name='apple-mobile-web-app-capable'/>
    <!-- Modern web app capable tag -->
    <meta content='yes' name='mobile-web-app-capable'/>
    <meta content='black-translucent' name='apple-mobile-web-app-status-bar-style'/>
    <title><data:blog.pageTitle/></title>
    
    <link href='https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&amp;display=swap' rel='stylesheet'/>
    <link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css' rel='stylesheet'/>

    <b:skin><![CDATA[
      /* ============================================
         SANTRILOGY AI - ULTRA RESPONSIVE
         ============================================ */
      
      :root {
        --bg-primary: #ffffff;
        --bg-secondary: #f8f9fb;
        --bg-tertiary: #f0f1f5;
        --bg-glass: rgba(255,255,255,0.85);
        --bg-modal: rgba(255,255,255,0.98);
        --text-primary: #111827;
        --text-secondary: #4b5563;
        --text-muted: #9ca3af;
        --accent: #6366f1;
        --accent-2: #8b5cf6;
        --accent-3: #06b6d4;
        --accent-soft: rgba(99,102,241,0.1);
        --gradient-1: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #06b6d4 100%);
        --gradient-2: linear-gradient(180deg, transparent 0%, var(--bg-primary) 100%);
        --border: rgba(0,0,0,0.08);
        --border-light: rgba(0,0,0,0.04);
        --shadow-xs: 0 1px 2px rgba(0,0,0,0.04);
        --shadow-sm: 0 2px 8px rgba(0,0,0,0.06);
        --shadow-md: 0 4px 20px rgba(0,0,0,0.08);
        --shadow-lg: 0 12px 40px rgba(0,0,0,0.12);
        --shadow-xl: 0 20px 50px rgba(0,0,0,0.15);
        --radius-xs: 8px;
        --radius-sm: 12px;
        --radius-md: 16px;
        --radius-lg: 24px;
        --radius-xl: 32px;
        --radius-full: 9999px;
        --safe-bottom: env(safe-area-inset-bottom, 0px);
        --safe-top: env(safe-area-inset-top, 0px);
        --header-h: 60px;
        --input-h: 130px;
        --sidebar-w: 280px;
        --font-xs: 11px;
        --font-sm: 13px;
        --font-base: 15px;
        --font-md: 16px;
        --font-lg: 18px;
        --font-xl: 24px;
        --font-2xl: 32px;
      }

      [data-theme="dark"] {
        --bg-primary: #09090b;
        --bg-secondary: #111113;
        --bg-tertiary: #18181b;
        --bg-glass: rgba(17,17,19,0.9);
        --bg-modal: rgba(17,17,19,0.98);
        --text-primary: #fafafa;
        --text-secondary: #a1a1aa;
        --text-muted: #52525b;
        --border: rgba(255,255,255,0.08);
        --border-light: rgba(255,255,255,0.04);
      }

      [data-accent="blue"] { --accent: #3b82f6; --accent-2: #2563eb; --accent-soft: rgba(59,130,246,0.1); }
      [data-accent="green"] { --accent: #10b981; --accent-2: #059669; --accent-soft: rgba(16,185,129,0.1); }
      [data-accent="purple"] { --accent: #8b5cf6; --accent-2: #7c3aed; --accent-soft: rgba(139,92,246,0.1); }
      [data-accent="pink"] { --accent: #ec4899; --accent-2: #db2777; --accent-soft: rgba(236,72,153,0.1); }
      [data-accent="orange"] { --accent: #f97316; --accent-2: #ea580c; --accent-soft: rgba(249,115,22,0.1); }

      [data-fontsize="small"] { --font-base: 13px; --font-md: 14px; }
      [data-fontsize="large"] { --font-base: 17px; --font-md: 18px; }

      *, *::before, *::after {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
      }

      html { height: 100%; height: -webkit-fill-available; }

      body {
        font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
        background: var(--bg-primary);
        color: var(--text-primary);
        font-size: var(--font-base);
        line-height: 1.6;
        min-height: 100vh;
        min-height: -webkit-fill-available;
        overflow-x: hidden;
        -webkit-font-smoothing: antialiased;
        transition: background 0.3s, color 0.3s;
      }

      body::before {
        content: '';
        position: fixed;
        inset: 0;
        background: 
          radial-gradient(ellipse at 20% 0%, rgba(99,102,241,0.05) 0%, transparent 50%),
          radial-gradient(ellipse at 80% 100%, rgba(139,92,246,0.05) 0%, transparent 50%);
        pointer-events: none;
        z-index: -1;
      }

      a { text-decoration: none; color: inherit; }
      button { font-family: inherit; cursor: pointer; border: none; background: none; }
      .navbar, .attribution, #blog-pager, .post-footer, .post-header { display: none !important; }

      /* ============================================
         ANIMATED ATOM LOGO
         ============================================ */
      
      .atom-logo {
        width: 40px;
        height: 40px;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
      }

      .atom-nucleus {
        width: 8px;
        height: 8px;
        background: var(--gradient-1);
        border-radius: 50%;
        position: absolute;
        box-shadow: 0 0 15px rgba(99,102,241,0.5);
        animation: pulse 2s ease-in-out infinite;
      }

      @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.15); }
      }

      .atom-orbit {
        position: absolute;
        border: 1.5px solid;
        border-radius: 50%;
        animation: spin 3s linear infinite;
      }

      .atom-orbit::after {
        content: '';
        position: absolute;
        width: 5px;
        height: 5px;
        background: currentColor;
        border-radius: 50%;
        top: -2.5px;
        left: 50%;
        transform: translateX(-50%);
        box-shadow: 0 0 6px currentColor;
      }

      .orbit-1 { width: 28px; height: 28px; border-color: rgba(99,102,241,0.4); color: #6366f1; animation-duration: 2s; }
      .orbit-2 { width: 32px; height: 18px; border-color: rgba(139,92,246,0.4); color: #8b5cf6; animation-duration: 2.5s; transform: rotate(60deg); animation-name: spin2; }
      .orbit-3 { width: 32px; height: 18px; border-color: rgba(6,182,212,0.4); color: #06b6d4; animation-duration: 3s; transform: rotate(-60deg); animation-name: spin3; }

      @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
      @keyframes spin2 { from { transform: rotate(60deg); } to { transform: rotate(420deg); } }
      @keyframes spin3 { from { transform: rotate(-60deg); } to { transform: rotate(300deg); } }

      .atom-lg { width: 100px; height: 100px; }
      .atom-lg .atom-nucleus { width: 18px; height: 18px; }
      .atom-lg .orbit-1 { width: 60px; height: 60px; }
      .atom-lg .orbit-2, .atom-lg .orbit-3 { width: 80px; height: 40px; }
      .atom-lg .atom-orbit::after { width: 10px; height: 10px; top: -5px; }

      .atom-mini { width: 100%; height: 100%; }
      .atom-mini .atom-nucleus { width: 5px; height: 5px; background: white; box-shadow: none; }
      .atom-mini .atom-orbit { border-width: 1px; }
      .atom-mini .orbit-1 { width: 20px; height: 20px; border-color: rgba(255,255,255,0.5); }
      .atom-mini .atom-orbit::after { width: 3px; height: 3px; top: -1.5px; background: white; box-shadow: none; }

      /* ============================================
         LAYOUT
         ============================================ */
      
      .app {
        display: flex;
        height: 100vh;
        height: 100dvh;
        position: relative;
        overflow: hidden;
      }

      /* ============================================
         SIDEBAR
         ============================================ */
      
      .sidebar {
        width: var(--sidebar-w);
        background: var(--bg-glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-right: 1px solid var(--border);
        display: flex;
        flex-direction: column;
        height: 100%;
        position: fixed;
        left: 0;
        top: 0;
        z-index: 200;
        transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .sidebar.collapsed { transform: translateX(-100%); }

      .sidebar-header {
        padding: 16px;
        border-bottom: 1px solid var(--border);
        display: flex;
        align-items: center;
        justify-content: space-between;
        min-height: var(--header-h);
      }

      .logo-wrap {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .logo-text {
        font-size: var(--font-lg);
        font-weight: 700;
        background: var(--gradient-1);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .sidebar-close {
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--bg-tertiary);
        border-radius: var(--radius-xs);
        color: var(--text-muted);
        transition: all 0.2s;
      }

      .sidebar-close:hover {
        background: var(--border);
        color: var(--text-primary);
      }

      .new-chat-btn {
        margin: 16px;
        padding: 14px;
        background: var(--gradient-1);
        border-radius: var(--radius-sm);
        color: white;
        font-size: var(--font-sm);
        font-weight: 600;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        transition: all 0.3s;
        box-shadow: 0 4px 15px rgba(99,102,241,0.25);
      }

      .new-chat-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(99,102,241,0.35);
      }

      .sidebar-nav {
        flex: 1;
        padding: 8px;
        overflow-y: auto;
        overscroll-behavior: contain;
      }

      .nav-group { margin-bottom: 16px; }

      .nav-label {
        font-size: var(--font-xs);
        font-weight: 600;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.8px;
        padding: 8px 12px;
      }

      .nav-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 11px 12px;
        border-radius: var(--radius-xs);
        color: var(--text-secondary);
        font-size: var(--font-sm);
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
        width: 100%;
        text-align: left;
      }

      .nav-item:hover {
        background: var(--bg-tertiary);
        color: var(--text-primary);
      }

      .nav-item.active {
        background: var(--accent-soft);
        color: var(--accent);
      }

      .nav-item i { width: 18px; text-align: center; }

      /* Sidebar Footer with Settings Dropdown */
      .sidebar-footer {
        padding: 12px;
        border-top: 1px solid var(--border);
        position: relative;
      }

      .profile-card {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 10px;
        border-radius: var(--radius-sm);
        cursor: pointer;
        transition: background 0.2s;
      }

      .profile-card:hover { background: var(--bg-tertiary); }

      .profile-avatar {
        width: 40px;
        height: 40px;
        background: var(--gradient-1);
        border-radius: var(--radius-xs);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: var(--font-sm);
      }

      .profile-info { flex: 1; min-width: 0; }

      .profile-name {
        font-size: var(--font-sm);
        font-weight: 600;
        color: var(--text-primary);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .profile-plan {
        font-size: var(--font-xs);
        color: var(--text-muted);
      }

      /* ============================================
         DESKTOP SETTINGS DROPDOWN
         ============================================ */
      
      .settings-dropdown {
        position: absolute;
        bottom: calc(100% + 8px);
        left: 12px;
        right: 12px;
        background: var(--bg-modal);
        border: 1px solid var(--border);
        border-radius: var(--radius-md);
        box-shadow: var(--shadow-xl);
        opacity: 0;
        visibility: hidden;
        transform: translateY(10px) scale(0.95);
        transform-origin: bottom center;
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 500;
        overflow: hidden;
      }

      .settings-dropdown.show {
        opacity: 1;
        visibility: visible;
        transform: translateY(0) scale(1);
      }

      .dropdown-header {
        padding: 14px 16px;
        border-bottom: 1px solid var(--border-light);
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .dropdown-title {
        font-size: var(--font-sm);
        font-weight: 600;
        color: var(--text-primary);
      }

      .dropdown-close {
        width: 28px;
        height: 28px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--bg-tertiary);
        border-radius: 6px;
        color: var(--text-muted);
        font-size: 12px;
        transition: all 0.2s;
      }

      .dropdown-close:hover {
        background: var(--border);
        color: var(--text-primary);
      }

      .dropdown-body {
        padding: 8px;
        max-height: 400px;
        overflow-y: auto;
      }

      .dropdown-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px;
        border-radius: var(--radius-xs);
        transition: background 0.2s;
      }

      .dropdown-item:hover {
        background: var(--bg-tertiary);
      }

      .dropdown-item-label {
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: var(--font-sm);
        font-weight: 500;
        color: var(--text-primary);
      }

      .dropdown-item-label i {
        width: 18px;
        color: var(--text-muted);
        font-size: 14px;
      }

      .dropdown-divider {
        height: 1px;
        background: var(--border-light);
        margin: 8px 0;
      }

      /* Toggle Mini */
      .toggle-mini {
        width: 40px;
        height: 22px;
        background: var(--bg-tertiary);
        border-radius: 11px;
        position: relative;
        cursor: pointer;
        transition: background 0.3s;
        border: 1px solid var(--border);
      }

      .toggle-mini::after {
        content: '';
        position: absolute;
        width: 16px;
        height: 16px;
        background: white;
        border-radius: 50%;
        top: 2px;
        left: 2px;
        transition: transform 0.3s;
        box-shadow: var(--shadow-xs);
      }

      .toggle-mini.on { background: var(--accent); border-color: var(--accent); }
      .toggle-mini.on::after { transform: translateX(18px); }

      /* Color Pills */
      .color-pills {
        display: flex;
        gap: 6px;
      }

      .color-pill {
        width: 22px;
        height: 22px;
        border-radius: 50%;
        border: 2px solid transparent;
        cursor: pointer;
        transition: all 0.2s;
      }

      .color-pill:hover { transform: scale(1.15); }
      .color-pill.active { border-color: var(--text-primary); }

      .color-pill.c-indigo { background: #6366f1; }
      .color-pill.c-blue { background: #3b82f6; }
      .color-pill.c-green { background: #10b981; }
      .color-pill.c-purple { background: #8b5cf6; }
      .color-pill.c-pink { background: #ec4899; }
      .color-pill.c-orange { background: #f97316; }

      /* Size Buttons */
      .size-btns {
        display: flex;
        gap: 4px;
      }

      .size-btn {
        padding: 4px 10px;
        background: var(--bg-tertiary);
        border: 1px solid var(--border);
        border-radius: 6px;
        font-size: var(--font-xs);
        font-weight: 600;
        color: var(--text-muted);
        cursor: pointer;
        transition: all 0.2s;
      }

      .size-btn:hover { border-color: var(--accent); color: var(--accent); }
      .size-btn.active { background: var(--accent-soft); border-color: var(--accent); color: var(--accent); }

      /* ============================================
         MAIN
         ============================================ */
      
      .main {
        flex: 1;
        display: flex;
        flex-direction: column;
        height: 100%;
        margin-left: var(--sidebar-w);
        transition: margin-left 0.35s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
      }

      .sidebar.collapsed ~ .main { margin-left: 0; }

      .header {
        height: var(--header-h);
        padding: 0 16px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: var(--bg-glass);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-bottom: 1px solid var(--border);
        position: sticky;
        top: 0;
        z-index: 100;
        padding-top: var(--safe-top);
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .menu-btn {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--bg-tertiary);
        border-radius: var(--radius-xs);
        color: var(--text-secondary);
        font-size: 18px;
        transition: all 0.2s;
      }

      .menu-btn:hover {
        background: var(--border);
        color: var(--text-primary);
      }

      .model-badge {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 12px;
        background: var(--bg-tertiary);
        border-radius: var(--radius-full);
        font-size: var(--font-xs);
        font-weight: 600;
        color: var(--text-secondary);
      }

      .model-dot {
        width: 6px;
        height: 6px;
        background: #22c55e;
        border-radius: 50%;
        animation: blink 2s infinite;
      }

      @keyframes blink {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.4; }
      }

      .header-right {
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .icon-btn {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: var(--radius-xs);
        color: var(--text-muted);
        font-size: 18px;
        transition: all 0.2s;
      }

      .icon-btn:hover {
        background: var(--bg-tertiary);
        color: var(--text-primary);
      }

      /* ============================================
         CHAT AREA
         ============================================ */
      
      .chat-area {
        flex: 1;
        overflow-y: auto;
        overscroll-behavior: contain;
        -webkit-overflow-scrolling: touch;
        padding: 24px 16px;
        padding-bottom: calc(var(--input-h) + 20px);
      }

      .chat-container {
        max-width: 720px;
        margin: 0 auto;
        width: 100%;
      }

      .post-outer {
        margin-bottom: 28px;
        animation: msgIn 0.4s ease-out;
      }

      @keyframes msgIn {
        from { opacity: 0; transform: translateY(16px); }
        to { opacity: 1; transform: translateY(0); }
      }

      .msg {
        display: flex;
        gap: 14px;
        align-items: flex-start;
      }

      .msg-avatar {
        width: 36px;
        height: 36px;
        border-radius: var(--radius-xs);
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
      }

      .msg-avatar.ai {
        background: var(--gradient-1);
        box-shadow: 0 4px 12px rgba(99,102,241,0.25);
      }

      .msg-avatar.user {
        background: var(--bg-tertiary);
        color: var(--text-secondary);
        font-weight: 600;
        font-size: var(--font-sm);
      }

      .msg-body { flex: 1; min-width: 0; }

      .msg-header {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 8px;
      }

      .msg-name {
        font-size: var(--font-sm);
        font-weight: 600;
        color: var(--text-primary);
      }

      .msg-time {
        font-size: var(--font-xs);
        color: var(--text-muted);
      }

      .post-body {
        font-size: var(--font-base);
        line-height: 1.75;
        color: var(--text-primary);
      }

      .post-body p { margin-bottom: 14px; }
      .post-body p:last-child { margin-bottom: 0; }

      .post-body h2, .post-body h3 {
        font-size: var(--font-md);
        font-weight: 600;
        margin: 20px 0 10px;
      }

      .post-body blockquote {
        border-left: 3px solid var(--accent);
        background: var(--accent-soft);
        padding: 14px 16px;
        margin: 14px 0;
        border-radius: 0 var(--radius-xs) var(--radius-xs) 0;
        font-style: italic;
      }

      .post-body code {
        background: var(--bg-tertiary);
        padding: 2px 6px;
        border-radius: 4px;
        font-size: var(--font-sm);
        font-family: 'SF Mono', Consolas, monospace;
      }

      .msg-actions {
        display: flex;
        gap: 4px;
        margin-top: 12px;
        opacity: 0;
        transition: opacity 0.2s;
      }

      .post-outer:hover .msg-actions { opacity: 1; }

      .msg-action {
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 6px;
        color: var(--text-muted);
        cursor: pointer;
        transition: all 0.2s;
        font-size: 12px;
      }

      .msg-action:hover {
        background: var(--bg-tertiary);
        color: var(--accent);
      }

      /* ============================================
         WELCOME SCREEN
         ============================================ */
      
      .welcome {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 60vh;
        text-align: center;
        padding: 32px 20px;
      }

      .welcome-glow {
        position: absolute;
        width: 180px;
        height: 180px;
        background: var(--gradient-1);
        filter: blur(80px);
        opacity: 0.2;
        animation: glowMove 6s ease-in-out infinite;
      }

      @keyframes glowMove {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.2); }
      }

      .welcome-logo {
        position: relative;
        margin-bottom: 28px;
      }

      .welcome h1 {
        font-size: var(--font-2xl);
        font-weight: 700;
        background: var(--gradient-1);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 10px;
      }

      .welcome p {
        font-size: var(--font-md);
        color: var(--text-secondary);
        max-width: 380px;
        margin-bottom: 36px;
      }

      .suggestions {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        width: 100%;
        max-width: 500px;
      }

      .sug-card {
        padding: 16px;
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: var(--radius-sm);
        text-align: left;
        cursor: pointer;
        transition: all 0.25s;
      }

      .sug-card:hover {
        border-color: var(--accent);
        transform: translateY(-3px);
        box-shadow: var(--shadow-md);
      }

      .sug-icon {
        width: 32px;
        height: 32px;
        background: var(--accent-soft);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--accent);
        font-size: 14px;
        margin-bottom: 10px;
      }

      .sug-title {
        font-size: var(--font-sm);
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 4px;
      }

      .sug-desc {
        font-size: var(--font-xs);
        color: var(--text-muted);
        line-height: 1.4;
      }

      /* ============================================
         INPUT AREA
         ============================================ */
      
      .input-area {
        position: fixed;
        bottom: 0;
        left: var(--sidebar-w);
        right: 0;
        background: var(--gradient-2);
        padding: 16px;
        padding-bottom: calc(16px + var(--safe-bottom));
        z-index: 100;
        transition: left 0.35s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .sidebar.collapsed ~ .main .input-area { left: 0; }

      .input-wrap {
        max-width: 720px;
        margin: 0 auto;
        position: relative;
      }

      .input-box {
        display: flex;
        align-items: flex-end;
        gap: 8px;
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: var(--radius-lg);
        padding: 10px 12px;
        transition: all 0.25s;
        box-shadow: var(--shadow-sm);
      }

      .input-box:focus-within {
        border-color: var(--accent);
        box-shadow: var(--shadow-md), 0 0 0 3px var(--accent-soft);
      }

      .input-left, .input-right {
        display: flex;
        align-items: center;
        flex-shrink: 0;
      }

      .input-btn {
        width: 42px;
        height: 42px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: var(--radius-xs);
        color: var(--text-muted);
        font-size: 20px;
        transition: all 0.2s;
        position: relative;
      }

      .input-btn:hover {
        background: var(--bg-tertiary);
        color: var(--text-secondary);
      }

      .input-btn.plus { color: var(--accent); }

      .input-field {
        flex: 1;
        border: none;
        background: transparent;
        font-family: inherit;
        font-size: var(--font-base);
        line-height: 1.5;
        color: var(--text-primary);
        resize: none;
        outline: none;
        min-height: 24px;
        max-height: 120px;
        padding: 9px 0;
      }

      .input-field::placeholder { color: var(--text-muted); }

      .send-mic-btn {
        width: 42px;
        height: 42px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: var(--radius-sm);
        font-size: 18px;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
      }

      .send-mic-btn.mic {
        background: var(--bg-tertiary);
        color: var(--text-secondary);
      }

      .send-mic-btn.send {
        background: var(--gradient-1);
        color: white;
        box-shadow: 0 4px 12px rgba(99,102,241,0.3);
        transform: scale(1.05);
      }

      .send-mic-btn.send:hover {
        transform: scale(1.1);
        box-shadow: 0 6px 20px rgba(99,102,241,0.4);
      }

      .input-footer {
        text-align: center;
        margin-top: 10px;
        font-size: var(--font-xs);
        color: var(--text-muted);
      }

      /* ============================================
         DESKTOP TOOLS DROPDOWN
         ============================================ */
      
      .tools-dropdown {
        position: absolute;
        bottom: calc(100% + 12px);
        left: 0;
        width: 320px;
        background: var(--bg-modal);
        border: 1px solid var(--border);
        border-radius: var(--radius-md);
        box-shadow: var(--shadow-xl);
        opacity: 0;
        visibility: hidden;
        transform: translateY(10px) scale(0.95);
        transform-origin: bottom left;
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 500;
        overflow: hidden;
      }

      .tools-dropdown.show {
        opacity: 1;
        visibility: visible;
        transform: translateY(0) scale(1);
      }

      .dropdown-section {
        padding: 12px;
        border-bottom: 1px solid var(--border-light);
      }

      .dropdown-section:last-child { border-bottom: none; }

      .dropdown-label {
        font-size: var(--font-xs);
        font-weight: 600;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 10px;
        padding: 0 4px;
      }

      .dropdown-upload {
        display: flex;
        gap: 8px;
      }

      .upload-item {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 6px;
        padding: 14px 10px;
        background: var(--bg-tertiary);
        border: 1px solid transparent;
        border-radius: var(--radius-sm);
        cursor: pointer;
        transition: all 0.2s;
      }

      .upload-item:hover {
        border-color: var(--accent);
        background: var(--accent-soft);
      }

      .upload-item i {
        font-size: 20px;
        color: var(--accent);
      }

      .upload-item span {
        font-size: var(--font-xs);
        font-weight: 500;
        color: var(--text-primary);
      }

      .dropdown-tools {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 6px;
      }

      .tool-item {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 12px;
        border-radius: var(--radius-xs);
        cursor: pointer;
        transition: all 0.2s;
      }

      .tool-item:hover {
        background: var(--bg-tertiary);
      }

      .tool-item i {
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--accent-soft);
        border-radius: var(--radius-xs);
        color: var(--accent);
        font-size: 14px;
        flex-shrink: 0;
      }

      .tool-item span {
        font-size: var(--font-sm);
        font-weight: 500;
        color: var(--text-primary);
      }

      /* ============================================
         MOBILE MODALS - Swipe Up Sheet
         ============================================ */
      
      .modal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.4);
        backdrop-filter: blur(4px);
        -webkit-backdrop-filter: blur(4px);
        z-index: 500;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s;
      }

      .modal-overlay.show {
        opacity: 1;
        visibility: visible;
      }

      .mobile-modal {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: var(--bg-modal);
        border-radius: var(--radius-xl) var(--radius-xl) 0 0;
        z-index: 501;
        transform: translateY(100%);
        transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        max-height: 85vh;
        overflow: hidden;
        display: none;
        flex-direction: column;
      }

      .mobile-modal.show { transform: translateY(0); }

      .modal-handle {
        width: 36px;
        height: 4px;
        background: var(--border);
        border-radius: 2px;
        margin: 12px auto;
        flex-shrink: 0;
      }

      .modal-header {
        padding: 8px 20px 16px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        border-bottom: 1px solid var(--border);
        flex-shrink: 0;
      }

      .modal-title {
        font-size: var(--font-md);
        font-weight: 600;
        color: var(--text-primary);
      }

      .modal-close {
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--bg-tertiary);
        border-radius: var(--radius-xs);
        color: var(--text-muted);
        font-size: 14px;
      }

      .modal-body {
        padding: 16px 20px;
        overflow-y: auto;
        flex: 1;
        padding-bottom: calc(20px + var(--safe-bottom));
      }

      .modal-section { margin-bottom: 24px; }
      .modal-section:last-child { margin-bottom: 0; }

      .modal-section-title {
        font-size: var(--font-xs);
        font-weight: 600;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 12px;
      }

      .modal-upload-grid {
        display: flex;
        gap: 12px;
      }

      .modal-upload-btn {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
        padding: 20px 16px;
        background: var(--bg-tertiary);
        border: 1px solid var(--border);
        border-radius: var(--radius-sm);
        cursor: pointer;
        transition: all 0.2s;
      }

      .modal-upload-btn:active {
        border-color: var(--accent);
        background: var(--accent-soft);
      }

      .modal-upload-btn i {
        font-size: 24px;
        color: var(--accent);
      }

      .modal-upload-btn span {
        font-size: var(--font-sm);
        font-weight: 500;
        color: var(--text-primary);
      }

      .modal-tools-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
      }

      .modal-tool-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 14px;
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: var(--radius-sm);
        cursor: pointer;
        transition: all 0.2s;
      }

      .modal-tool-item:active {
        border-color: var(--accent);
        transform: scale(0.98);
      }

      .modal-tool-icon {
        width: 40px;
        height: 40px;
        background: var(--accent-soft);
        border-radius: var(--radius-xs);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--accent);
        font-size: 16px;
        flex-shrink: 0;
      }

      .modal-tool-info { flex: 1; min-width: 0; }

      .modal-tool-name {
        font-size: var(--font-sm);
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 2px;
      }

      .modal-tool-desc {
        font-size: var(--font-xs);
        color: var(--text-muted);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      /* Mobile Settings Items */
      .mobile-setting-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 14px 0;
        border-bottom: 1px solid var(--border-light);
      }

      .mobile-setting-item:last-child { border-bottom: none; }

      .mobile-setting-label {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: var(--font-sm);
        font-weight: 500;
        color: var(--text-primary);
      }

      .mobile-setting-label i {
        width: 20px;
        color: var(--text-muted);
      }

      .toggle-switch {
        width: 48px;
        height: 28px;
        background: var(--bg-tertiary);
        border-radius: 14px;
        position: relative;
        cursor: pointer;
        transition: background 0.3s;
      }

      .toggle-switch::after {
        content: '';
        position: absolute;
        width: 22px;
        height: 22px;
        background: white;
        border-radius: 50%;
        top: 3px;
        left: 3px;
        transition: transform 0.3s;
        box-shadow: var(--shadow-xs);
      }

      .toggle-switch.on { background: var(--accent); }
      .toggle-switch.on::after { transform: translateX(20px); }

      .mobile-color-options {
        display: flex;
        gap: 8px;
      }

      .mobile-color-btn {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        border: 2px solid transparent;
        cursor: pointer;
        transition: all 0.2s;
      }

      .mobile-color-btn.active { border-color: var(--text-primary); }

      .mobile-fontsize-btns {
        display: flex;
        gap: 6px;
      }

      .mobile-fontsize-btn {
        padding: 6px 12px;
        background: var(--bg-tertiary);
        border: 1px solid var(--border);
        border-radius: 6px;
        font-size: var(--font-xs);
        font-weight: 600;
        color: var(--text-muted);
        cursor: pointer;
        transition: all 0.2s;
      }

      .mobile-fontsize-btn.active {
        background: var(--accent-soft);
        border-color: var(--accent);
        color: var(--accent);
      }

      /* ============================================
         OVERLAY
         ============================================ */
      
      .overlay {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.5);
        backdrop-filter: blur(4px);
        -webkit-backdrop-filter: blur(4px);
        z-index: 199;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s;
      }

      .overlay.show {
        opacity: 1;
        visibility: visible;
      }

      /* ============================================
         RESPONSIVE - Desktop (dropdowns)
         ============================================ */
      
      @media (min-width: 769px) {
        .tools-dropdown,
        .settings-dropdown { display: block; }
        
        .mobile-modal { display: none !important; }
        .modal-overlay.mobile-overlay { display: none !important; }
      }

      /* ============================================
         RESPONSIVE - Mobile (modals)
         ============================================ */
      
      @media (max-width: 768px) {
        :root {
          --header-h: 56px;
          --input-h: 110px;
        }

        .tools-dropdown,
        .settings-dropdown { display: none !important; }
        
        .mobile-modal { display: flex; }

        .sidebar {
          position: fixed;
          width: 85%;
          max-width: 300px;
        }

        .main { margin-left: 0 !important; }
        .input-area { left: 0 !important; }
        .header { padding: 0 12px; }

        .model-badge span { display: none; }
        .model-badge { padding: 8px; min-width: 30px; justify-content: center; }

        .chat-area {
          padding: 16px 12px;
          padding-bottom: calc(var(--input-h) + 16px);
        }

        .suggestions { grid-template-columns: 1fr; }
        .welcome h1 { font-size: var(--font-xl); }
        .welcome p { font-size: var(--font-sm); }

        .msg { gap: 10px; }
        .msg-avatar { width: 32px; height: 32px; }

        .input-box { padding: 8px 10px; }
      }

      @media (max-width: 380px) {
        :root {
          --font-base: 14px;
          --font-md: 15px;
        }

        .input-btn { width: 38px; height: 38px; font-size: 18px; }
        .send-mic-btn { width: 38px; height: 38px; }

        .modal-upload-grid { flex-direction: column; }
        .modal-tools-grid { grid-template-columns: 1fr; }
      }

      @supports (padding: max(0px)) {
        .input-area { padding-bottom: max(16px, env(safe-area-inset-bottom)); }
        .header { padding-top: max(0px, env(safe-area-inset-top)); }
        .modal-body { padding-bottom: max(20px, env(safe-area-inset-bottom)); }
      }

      ::-webkit-scrollbar { width: 5px; height: 5px; }
      ::-webkit-scrollbar-track { background: transparent; }
      ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

      @media (max-width: 768px) {
        ::-webkit-scrollbar { display: none; }
        * { scrollbar-width: none; }
      }

    ]]></b:skin>
  </head>
  
  <body>
    <div class='app'>

      <div class='overlay' id='overlay' onclick='closeSidebar()'/>

      <!-- SIDEBAR -->
      <aside class='sidebar' id='sidebar'>
        <div class='sidebar-header'>
          <div class='logo-wrap'>
            <div class='atom-logo'>
              <div class='atom-nucleus'/>
              <div class='atom-orbit orbit-1'/>
              <div class='atom-orbit orbit-2'/>
              <div class='atom-orbit orbit-3'/>
            </div>
            <span class='logo-text'>Santrilogy</span>
          </div>
          <button class='sidebar-close' onclick='closeSidebar()'>
            <i class='fas fa-times'/>
          </button>
        </div>

        <button class='new-chat-btn' onclick='startNewChat()'>
          <i class='fas fa-plus'/>
          New Chat
        </button>

        <nav class='sidebar-nav'>
          <div class='nav-group'>
            <div class='nav-label'>Menu</div>
            <button class='nav-item active'>
              <i class='fas fa-message'/>
              <span>Chat</span>
            </button>
            <button class='nav-item'>
              <i class='fas fa-compass'/>
              <span>Explore</span>
            </button>
            <button class='nav-item'>
              <i class='fas fa-book-open'/>
              <span>Kitab Library</span>
            </button>
          </div>

          <div class='nav-group'>
            <div class='nav-label'>Recent</div>
            <button class='nav-item'>
              <i class='fas fa-clock-rotate-left'/>
              <span>History</span>
            </button>
            <button class='nav-item'>
              <i class='fas fa-bookmark'/>
              <span>Saved</span>
            </button>
          </div>

          <div class='nav-group'>
            <div class='nav-label'>More</div>
            <button class='nav-item' onclick='toggleSettings()'>
              <i class='fas fa-gear'/>
              <span>Settings</span>
            </button>
            <button class='nav-item'>
              <i class='fas fa-gem'/>
              <span>Upgrade Pro</span>
            </button>
          </div>
        </nav>

        <!-- Sidebar Footer with Profile & Settings Dropdown -->
        <div class='sidebar-footer'>
          <!-- Desktop Settings Dropdown -->
          <div class='settings-dropdown' id='settingsDropdown'>
            <div class='dropdown-header'>
              <span class='dropdown-title'>Settings</span>
              <button class='dropdown-close' onclick='closeSettingsDropdown()'>
                <i class='fas fa-times'/>
              </button>
            </div>
            <div class='dropdown-body'>
              <!-- Dark Mode -->
              <div class='dropdown-item'>
                <div class='dropdown-item-label'>
                  <i class='fas fa-moon'/>
                  <span>Dark Mode</span>
                </div>
                <button class='toggle-mini' id='darkToggleDesktop' onclick='toggleDarkMode()'/>
              </div>
              
              <div class='dropdown-divider'/>
              
              <!-- Theme Color -->
              <div class='dropdown-item'>
                <div class='dropdown-item-label'>
                  <i class='fas fa-palette'/>
                  <span>Color</span>
                </div>
                <div class='color-pills'>
                  <button class='color-pill c-indigo active' data-accent='indigo' onclick='setAccent(this)'/>
                  <button class='color-pill c-blue' data-accent='blue' onclick='setAccent(this)'/>
                  <button class='color-pill c-green' data-accent='green' onclick='setAccent(this)'/>
                  <button class='color-pill c-purple' data-accent='purple' onclick='setAccent(this)'/>
                  <button class='color-pill c-pink' data-accent='pink' onclick='setAccent(this)'/>
                  <button class='color-pill c-orange' data-accent='orange' onclick='setAccent(this)'/>
                </div>
              </div>

              <div class='dropdown-divider'/>

              <!-- Font Size -->
              <div class='dropdown-item'>
                <div class='dropdown-item-label'>
                  <i class='fas fa-text-height'/>
                  <span>Size</span>
                </div>
                <div class='size-btns'>
                  <button class='size-btn' data-size='small' onclick='setFontSize(this)'>S</button>
                  <button class='size-btn active' data-size='normal' onclick='setFontSize(this)'>M</button>
                  <button class='size-btn' data-size='large' onclick='setFontSize(this)'>L</button>
                </div>
              </div>

              <div class='dropdown-divider'/>

              <!-- Clear & Version -->
              <div class='dropdown-item' onclick='clearChats()' style='cursor: pointer;'>
                <div class='dropdown-item-label'>
                  <i class='fas fa-trash' style='color: #ef4444;'/>
                  <span style='color: #ef4444;'>Clear Chats</span>
                </div>
              </div>

              <div class='dropdown-item'>
                <div class='dropdown-item-label'>
                  <i class='fas fa-info-circle'/>
                  <span>Version</span>
                </div>
                <span style='font-size: 11px; color: var(--text-muted);'>v1.0.0</span>
              </div>
            </div>
          </div>

          <div class='profile-card' onclick='toggleSettings()'>
            <div class='profile-avatar'>S</div>
            <div class='profile-info'>
              <div class='profile-name'>Santri User</div>
              <div class='profile-plan'>Free Plan</div>
            </div>
            <i class='fas fa-chevron-up' id='profileChevron' style='color: var(--text-muted); font-size: 12px; transition: transform 0.3s;'/>
          </div>
        </div>
      </aside>

      <!-- MAIN -->
      <div class='main'>
        <header class='header'>
          <div class='header-left'>
            <button class='menu-btn' onclick='toggleSidebar()'>
              <i class='fas fa-bars'/>
            </button>
            <div class='model-badge'>
              <div class='model-dot'/>
              <span>Santrilogy AI</span>
            </div>
          </div>
          <div class='header-right'>
            <button class='icon-btn' title='Share'>
              <i class='fas fa-share-nodes'/>
            </button>
            <button class='icon-btn' title='More'>
              <i class='fas fa-ellipsis-vertical'/>
            </button>
          </div>
        </header>

        <div class='chat-area' id='chatArea'>
          <div class='chat-container'>
            <b:section id='main' showaddelement='yes'>
              <b:widget id='Blog1' locked='true' title='Postingan Blog' type='Blog' version='2' visible='true'>
                <b:widget-settings>
                  <b:widget-setting name='showDateHeader'>false</b:widget-setting>
                  <b:widget-setting name='style.textcolor'>#ffffff</b:widget-setting>
                  <b:widget-setting name='showShareButtons'>false</b:widget-setting>
                  <b:widget-setting name='showCommentLink'>false</b:widget-setting>
                  <b:widget-setting name='style.urlcolor'>#ffffff</b:widget-setting>
                  <b:widget-setting name='showAuthor'>false</b:widget-setting>
                  <b:widget-setting name='style.linkcolor'>#ffffff</b:widget-setting>
                  <b:widget-setting name='style.unittype'>TextAndImage</b:widget-setting>
                  <b:widget-setting name='style.bgcolor'>#ffffff</b:widget-setting>
                  <b:widget-setting name='reactionsLabel'/>
                  <b:widget-setting name='showAuthorProfile'>false</b:widget-setting>
                  <b:widget-setting name='style.layout'>1x1</b:widget-setting>
                  <b:widget-setting name='showLabels'>false</b:widget-setting>
                  <b:widget-setting name='showLocation'>false</b:widget-setting>
                  <b:widget-setting name='showTimestamp'>false</b:widget-setting>
                  <b:widget-setting name='postsPerAd'>1</b:widget-setting>
                  <b:widget-setting name='showBacklinks'>false</b:widget-setting>
                  <b:widget-setting name='style.bordercolor'>#ffffff</b:widget-setting>
                  <b:widget-setting name='showInlineAds'>false</b:widget-setting>
                  <b:widget-setting name='showReactions'>false</b:widget-setting>
                </b:widget-settings>
                <b:includable id='main'>
                  <b:if cond='data:posts.notEmpty'>
                    <b:loop values='data:posts' var='post'>
                      <article class='post-outer'>
                        <div class='msg'>
                          <div class='msg-avatar ai'>
                            <div class='atom-mini'>
                              <div class='atom-nucleus'/>
                              <div class='atom-orbit orbit-1'/>
                            </div>
                          </div>
                          <div class='msg-body'>
                            <div class='msg-header'>
                              <span class='msg-name'>Santrilogy AI</span>
                              <span class='msg-time'>Just now</span>
                            </div>
                            <div class='post-body'>
                              <data:post.body/>
                            </div>
                            <div class='msg-actions'>
                              <span class='msg-action' title='Copy'><i class='fas fa-copy'/></span>
                              <span class='msg-action' title='Regenerate'><i class='fas fa-rotate'/></span>
                              <span class='msg-action' title='Like'><i class='fas fa-thumbs-up'/></span>
                              <span class='msg-action' title='Dislike'><i class='fas fa-thumbs-down'/></span>
                            </div>
                          </div>
                        </div>
                      </article>
                    </b:loop>
                  <b:else/>
                    <div class='welcome'>
                      <div class='welcome-logo'>
                        <div class='welcome-glow'/>
                        <div class='atom-logo atom-lg'>
                          <div class='atom-nucleus'/>
                          <div class='atom-orbit orbit-1'/>
                          <div class='atom-orbit orbit-2'/>
                          <div class='atom-orbit orbit-3'/>
                        </div>
                      </div>
                      <h1>Santrilogy AI</h1>
                      <p>Asisten pintar untuk kajian Islam, fikih, dan kitab kuning</p>
                      <div class='suggestions'>
                        <div class='sug-card' onclick='askQuestion(&quot;Jelaskan hukum shalat jamak qasar&quot;)'>
                          <div class='sug-icon'><i class='fas fa-mosque'/></div>
                          <div class='sug-title'>Hukum Shalat</div>
                          <div class='sug-desc'>Fikih shalat jamak &amp; qasar</div>
                        </div>
                        <div class='sug-card' onclick='askQuestion(&quot;Apa saja rukun wudhu?&quot;)'>
                          <div class='sug-icon'><i class='fas fa-droplet'/></div>
                          <div class='sug-title'>Thaharah</div>
                          <div class='sug-desc'>Wudhu, tayamum, bersuci</div>
                        </div>
                        <div class='sug-card' onclick='askQuestion(&quot;Terjemahkan bait alfiyah&quot;)'>
                          <div class='sug-icon'><i class='fas fa-book-quran'/></div>
                          <div class='sug-title'>Kitab Kuning</div>
                          <div class='sug-desc'>Terjemah &amp; syarah kitab</div>
                        </div>
                        <div class='sug-card' onclick='askQuestion(&quot;Jelaskan rukun iman&quot;)'>
                          <div class='sug-icon'><i class='fas fa-heart'/></div>
                          <div class='sug-title'>Akidah</div>
                          <div class='sug-desc'>Dasar-dasar keimanan</div>
                        </div>
                      </div>
                    </div>
                  </b:if>
                </b:includable>
                <b:includable id='aboutPostAuthor'/>
                <b:includable id='addComments'/>
                <b:includable id='blogThisShare'/>
                <b:includable id='bylineByName' var='byline'/>
                <b:includable id='bylineRegion' var='regionItems'/>
                <b:includable id='commentAuthorAvatar'/>
                <b:includable id='commentDeleteIcon' var='comment'/>
                <b:includable id='commentForm' var='post'/>
                <b:includable id='commentFormIframeSrc' var='post'/>
                <b:includable id='commentItem' var='comment'/>
                <b:includable id='commentList' var='comments'/>
                <b:includable id='commentPicker' var='post'/>
                <b:includable id='comments' var='post'/>
                <b:includable id='commentsLink'/>
                <b:includable id='commentsLinkIframe'/>
                <b:includable id='commentsTitle'/>
                <b:includable id='defaultAdUnit'/>
                <b:includable id='emailPostIcon'/>
                <b:includable id='facebookShare'/>
                <b:includable id='feedLinks'/>
                <b:includable id='feedLinksBody' var='links'/>
                <b:includable id='footerBylines'/>
                <b:includable id='googlePlusShare'/>
                <b:includable id='headerByline'/>
                <b:includable id='homePageLink'/>
                <b:includable id='iframeComments' var='post'/>
                <b:includable id='inlineAd' var='post'/>
                <b:includable id='linkShare'/>
                <b:includable id='nextPageLink'/>
                <b:includable id='otherSharingButton'/>
                <b:includable id='platformShare'/>
                <b:includable id='post' var='post'/>
                <b:includable id='postAuthor'/>
                <b:includable id='postBody' var='post'/>
                <b:includable id='postBodySnippet' var='post'/>
                <b:includable id='postCommentsAndAd' var='post'/>
                <b:includable id='postCommentsLink'/>
                <b:includable id='postFooter' var='post'/>
                <b:includable id='postFooterAuthorProfile' var='post'/>
                <b:includable id='postHeader' var='post'/>
                <b:includable id='postJumpLink' var='post'/>
                <b:includable id='postLabels'/>
                <b:includable id='postLocation'/>
                <b:includable id='postMeta' var='post'/>
                <b:includable id='postMetadataJSONImage'/>
                <b:includable id='postMetadataJSONPublisher'/>
                <b:includable id='postPagination'/>
                <b:includable id='postReactions'/>
                <b:includable id='postShareButtons'/>
                <b:includable id='postTimestamp'/>
                <b:includable id='postTitle' var='post'/>
                <b:includable id='previousPageLink'/>
                <b:includable id='sharingButton'/>
                <b:includable id='sharingButtonContent'/>
                <b:includable id='sharingButtons'/>
                <b:includable id='sharingButtonsMenu'/>
                <b:includable id='sharingPlatformIcon'/>
                <b:includable id='threadedCommentForm' var='post'/>
                <b:includable id='threadedCommentJs' var='post'/>
                <b:includable id='threadedComments' var='post'/>
                <b:includable id='tooltipCss'/>
              </b:widget>
            </b:section>
          </div>
        </div>

        <!-- INPUT AREA -->
        <div class='input-area'>
          <div class='input-wrap'>
            
            <!-- DESKTOP: Tools Dropdown -->
            <div class='tools-dropdown' id='toolsDropdown'>
              <div class='dropdown-section'>
                <div class='dropdown-label'>Upload</div>
                <div class='dropdown-upload'>
                  <div class='upload-item' onclick='handleUpload(&quot;camera&quot;)'>
                    <i class='fas fa-camera'/>
                    <span>Camera</span>
                  </div>
                  <div class='upload-item' onclick='handleUpload(&quot;gallery&quot;)'>
                    <i class='fas fa-image'/>
                    <span>Gallery</span>
                  </div>
                  <div class='upload-item' onclick='handleUpload(&quot;document&quot;)'>
                    <i class='fas fa-file-alt'/>
                    <span>Document</span>
                  </div>
                </div>
              </div>
              <div class='dropdown-section'>
                <div class='dropdown-label'>Smart Tools</div>
                <div class='dropdown-tools'>
                  <div class='tool-item' onclick='useTool(&quot;terjemah&quot;)'>
                    <i class='fas fa-language'/>
                    <span>Terjemah Kitab</span>
                  </div>
                  <div class='tool-item' onclick='useTool(&quot;irob&quot;)'>
                    <i class='fas fa-diagram-project'/>
                    <span>Analisis I&#39;rob</span>
                  </div>
                  <div class='tool-item' onclick='useTool(&quot;harokat&quot;)'>
                    <i class='fas fa-text-height'/>
                    <span>Tasykil</span>
                  </div>
                  <div class='tool-item' onclick='useTool(&quot;logika&quot;)'>
                    <i class='fas fa-brain'/>
                    <span>Tes Logika</span>
                  </div>
                  <div class='tool-item' onclick='useTool(&quot;belajar&quot;)'>
                    <i class='fas fa-graduation-cap'/>
                    <span>Mode Belajar</span>
                  </div>
                  <div class='tool-item' onclick='useTool(&quot;quiz&quot;)'>
                    <i class='fas fa-question-circle'/>
                    <span>Quiz</span>
                  </div>
                </div>
              </div>
            </div>

            <div class='input-box'>
              <div class='input-left'>
                <button class='input-btn plus' id='plusBtn' onclick='toggleTools()' title='Tools'>
                  <i class='fas fa-plus-circle'/>
                </button>
              </div>
              <textarea class='input-field' id='userPrompt' oninput='handleInput()' onkeydown='handleKeyDown(event)' placeholder='Tanyakan sesuatu...' rows='1'/>
              <div class='input-right'>
                <button class='send-mic-btn mic' id='sendMicBtn' onclick='handleSendMic()'>
                  <i class='fas fa-microphone'/>
                </button>
              </div>
            </div>
            <p class='input-footer'>Santrilogy AI bisa keliru. Verifikasi ke ustadz.</p>
          </div>
        </div>
      </div>
    </div>

    <!-- MOBILE: Tools Modal -->
    <div class='modal-overlay mobile-overlay' id='toolsOverlay' onclick='closeToolsModal()'/>
    <div class='mobile-modal' id='toolsModal'>
      <div class='modal-handle'/>
      <div class='modal-header'>
        <span class='modal-title'>Tools &amp; Upload</span>
        <button class='modal-close' onclick='closeToolsModal()'>
          <i class='fas fa-times'/>
        </button>
      </div>
      <div class='modal-body'>
        <div class='modal-section'>
          <div class='modal-section-title'>Upload</div>
          <div class='modal-upload-grid'>
            <div class='modal-upload-btn' onclick='handleUpload(&quot;camera&quot;)'>
              <i class='fas fa-camera'/>
              <span>Camera</span>
            </div>
            <div class='modal-upload-btn' onclick='handleUpload(&quot;gallery&quot;)'>
              <i class='fas fa-image'/>
              <span>Gallery</span>
            </div>
            <div class='modal-upload-btn' onclick='handleUpload(&quot;document&quot;)'>
              <i class='fas fa-file-alt'/>
              <span>Document</span>
            </div>
          </div>
        </div>
        <div class='modal-section'>
          <div class='modal-section-title'>Smart Tools</div>
          <div class='modal-tools-grid'>
            <div class='modal-tool-item' onclick='useTool(&quot;terjemah&quot;)'>
              <div class='modal-tool-icon'><i class='fas fa-language'/></div>
              <div class='modal-tool-info'>
                <div class='modal-tool-name'>Terjemah Kitab</div>
                <div class='modal-tool-desc'>Terjemahkan teks Arab</div>
              </div>
            </div>
            <div class='modal-tool-item' onclick='useTool(&quot;irob&quot;)'>
              <div class='modal-tool-icon'><i class='fas fa-diagram-project'/></div>
              <div class='modal-tool-info'>
                <div class='modal-tool-name'>Analisis I&#39;rob</div>
                <div class='modal-tool-desc'>Parsing nahwu shorof</div>
              </div>
            </div>
            <div class='modal-tool-item' onclick='useTool(&quot;harokat&quot;)'>
              <div class='modal-tool-icon'><i class='fas fa-text-height'/></div>
              <div class='modal-tool-info'>
                <div class='modal-tool-name'>Tasykil (Harakat)</div>
                <div class='modal-tool-desc'>Beri harakat teks Arab</div>
              </div>
            </div>
            <div class='modal-tool-item' onclick='useTool(&quot;logika&quot;)'>
              <div class='modal-tool-icon'><i class='fas fa-brain'/></div>
              <div class='modal-tool-info'>
                <div class='modal-tool-name'>Tes Logika</div>
                <div class='modal-tool-desc'>Mantiq dan silogisme</div>
              </div>
            </div>
            <div class='modal-tool-item' onclick='useTool(&quot;belajar&quot;)'>
              <div class='modal-tool-icon'><i class='fas fa-graduation-cap'/></div>
              <div class='modal-tool-info'>
                <div class='modal-tool-name'>Mode Belajar</div>
                <div class='modal-tool-desc'>Penjelasan step by step</div>
              </div>
            </div>
            <div class='modal-tool-item' onclick='useTool(&quot;quiz&quot;)'>
              <div class='modal-tool-icon'><i class='fas fa-question-circle'/></div>
              <div class='modal-tool-info'>
                <div class='modal-tool-name'>Quiz Generator</div>
                <div class='modal-tool-desc'>Buat soal latihan</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- MOBILE: Settings Modal -->
    <div class='modal-overlay mobile-overlay' id='settingsOverlay' onclick='closeSettingsModal()'/>
    <div class='mobile-modal' id='settingsModal'>
      <div class='modal-handle'/>
      <div class='modal-header'>
        <span class='modal-title'>Settings</span>
        <button class='modal-close' onclick='closeSettingsModal()'>
          <i class='fas fa-times'/>
        </button>
      </div>
      <div class='modal-body'>
        <!-- Dark Mode -->
        <div class='mobile-setting-item'>
          <div class='mobile-setting-label'>
            <i class='fas fa-moon'/>
            <span>Dark Mode</span>
          </div>
          <button class='toggle-switch' id='darkToggleMobile' onclick='toggleDarkMode()'/>
        </div>

        <!-- Theme Color -->
        <div class='mobile-setting-item'>
          <div class='mobile-setting-label'>
            <i class='fas fa-palette'/>
            <span>Theme Color</span>
          </div>
          <div class='mobile-color-options'>
            <button class='mobile-color-btn active' data-accent='indigo' onclick='setAccent(this)' style='background: #6366f1;'/>
            <button class='mobile-color-btn' data-accent='blue' onclick='setAccent(this)' style='background: #3b82f6;'/>
            <button class='mobile-color-btn' data-accent='green' onclick='setAccent(this)' style='background: #10b981;'/>
            <button class='mobile-color-btn' data-accent='purple' onclick='setAccent(this)' style='background: #8b5cf6;'/>
            <button class='mobile-color-btn' data-accent='pink' onclick='setAccent(this)' style='background: #ec4899;'/>
            <button class='mobile-color-btn' data-accent='orange' onclick='setAccent(this)' style='background: #f97316;'/>
          </div>
        </div>

        <!-- Font Size -->
        <div class='mobile-setting-item'>
          <div class='mobile-setting-label'>
            <i class='fas fa-text-height'/>
            <span>Font Size</span>
          </div>
          <div class='mobile-fontsize-btns'>
            <button class='mobile-fontsize-btn' data-size='small' onclick='setFontSize(this)'>S</button>
            <button class='mobile-fontsize-btn active' data-size='normal' onclick='setFontSize(this)'>M</button>
            <button class='mobile-fontsize-btn' data-size='large' onclick='setFontSize(this)'>L</button>
          </div>
        </div>

        <!-- Clear Chats -->
        <div class='mobile-setting-item' onclick='clearChats()' style='cursor: pointer;'>
          <div class='mobile-setting-label'>
            <i class='fas fa-trash' style='color: #ef4444;'/>
            <span style='color: #ef4444;'>Clear All Chats</span>
          </div>
          <i class='fas fa-chevron-right' style='color: var(--text-muted); font-size: 12px;'/>
        </div>

        <!-- About -->
        <div class='mobile-setting-item'>
          <div class='mobile-setting-label'>
            <i class='fas fa-info-circle'/>
            <span>About</span>
          </div>
          <span style='color: var(--text-muted); font-size: 12px;'>v1.0.0</span>
        </div>

        <!-- Help -->
        <div class='mobile-setting-item' style='cursor: pointer;'>
          <div class='mobile-setting-label'>
            <i class='fas fa-question-circle'/>
            <span>Help &amp; Feedback</span>
          </div>
          <i class='fas fa-chevron-right' style='color: var(--text-muted); font-size: 12px;'/>
        </div>
      </div>
    </div>

    <!-- External JavaScript for Santrilogy AI -->
    <script src="https://cdn.jsdelivr.net/gh/yourusername/santrilogy-ai@main/optimized-assets/js/app.js"></script>
  </body>
</html>